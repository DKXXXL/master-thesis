\begin{abstract}
\input{abstract}
\end{abstract}

\maketitle

% lstlisting coq style (inspired from a file of Assia Mahboubi)
% https://tex.stackexchange.com/questions/434523/coq-syntax-highlighting
\section{Introduction}
\label{sec:intro}
\input{introduction.tex}

% Concept 
% Contribution

\section{Design Requirements and Challenges}
% what feature we want
% what problem/formalization we want to achieve
% Before/After Comparison of examples (with/without Fampoly)
\label{sec:background+challenge}
\input{challenge.tex}

\section{Language Design}
% we need to make this section before Metatheory
% because a lot of our formulation in the metatheory
%   is inspired by the implementation
\label{sec:lang-design}
\input{lang-design.tex}

\section{Compiling Family Polymorphism to Parameterized Modules}
% we need to make this section before Metatheory
% because a lot of our formulation in the metatheory
%   is inspired by the implementation
\label{sec:coqimpl}
\input{coqimpl.tex}


\section{Metatheory}
\label{sec:metatheory2}
\input{metatheory-condensed.tex}

\section{Related Work}\label{sec:related-work}
\input{related-work.tex}

\section{Limitations and Conclusion}
\label{sec:conclusion}

It is hard to write modular, extensible code and proofs.
We have presented the first language design that

... make exciting directions for future work.


\setlength{\bibsep}{.8ex}
\bibliographystyle{tex-macros/ACM-Reference-Format.bst}
\bibliography{refs.bib}

\appendix

\section{Metatheory in (pseudo-)Agda}
We make four agda source code files (publicly and anonymously) openly avaliable, and they include the corresponding QIIT syntax definition and models. 

For syntax, please check \\ \href{https://drive.google.com/file/d/1aoG67rmXzP_x1MvZCIN3do0sucyqjwkn/view?usp=sharing}{https://drive.google.com/file/d/1aoG67rmXzP_x1MvZCIN3do0sucyqjwkn/view?usp=sharing}. This is done by mainly following the formulation \citet{altkap2016}. This is also very close to \citet{coquand2018canonicity} and \citet{sterling2019algebraic} but we formulate our syntax in a type-theoretic framework.

For syntactic translation, please check \\ \href{https://drive.google.com/file/d/1pMqn8DS4T4jiCubzk3HgMANjrfKpcGlI/view?usp=sharing}{https://drive.google.com/file/d/1pMqn8DS4T4jiCubzk3HgMANjrfKpcGlI/view?usp=sharing}. This is the first QIIT-model we give. A QIIT-model can be consider as an arbitrary mapping from the QIIT data(our syntax in this case), also respecting the quotient(judgemental equality in this case). Here we use (a subpart of) QIIT data itself as the destination of the mapping. 

For consistency model, please check \\ \href{https://drive.google.com/file/d/1pNhnn125P5byAHDaSIlpbxMvr1F-9FRo/view?usp=sharing}{https://drive.google.com/file/d/1pNhnn125P5byAHDaSIlpbxMvr1F-9FRo/view?usp=sharing}. This is following the standard model from \citet{altkap2016,kaposi2017type,kaposi2019gluing}.

For canonicity model, please check \\ \href{https://drive.google.com/file/d/1R6C7QNfyu8fbl6LE2ruvpqZ_ZDSRVo0c/view?usp=sharing}{https://drive.google.com/file/d/1R6C7QNfyu8fbl6LE2ruvpqZ_ZDSRVo0c/view?usp=sharing}. This is mainly following \citet{coquand2018canonicity,sterling2019algebraic}, but we carried out our argument in a type-theortic framework.  We call it canonicity model to emphasize that it is a model used to prove canonicity, it is also called reducibility argument, as an instance of proof-relevant logical relation. This argument can be considered as a verbose/more concrete version of \citet{kaposi2019gluing}.

We suggest using editors with proper syntax highlighting, e.g. VSCode with agda-code plugins, to read these source files.

\section{Typing Rules in one Figure}
\include{all-typing-rule.tex}

\section{Metatheory, in detail}

\label{sec:metatheory}
\input{metatheory.tex}

\section{Example in Metatheory}\label{sec:coqexample}
\input{coq-example.tex}