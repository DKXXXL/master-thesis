\begin{abstract}
\input{abstract}
\end{abstract}

\maketitle

% lstlisting coq style (inspired from a file of Assia Mahboubi)
% https://tex.stackexchange.com/questions/434523/coq-syntax-highlighting
\section{Introduction}
\label{sec:intro}
\input{introduction.tex}

% Concept 
% Contribution

\section{Design Requirements and Challenges}
% what feature we want
% what problem/formalization we want to achieve
% Before/After Comparison of examples (with/without Fampoly)
\label{sec:background+challenge}
\input{challenge.tex}

\section{Language Design}
% we need to make this section before Metatheory
% because a lot of our formulation in the metatheory
%   is inspired by the implementation
\label{sec:lang-design}
\input{lang-design.tex}

\section{Compiling Family Polymorphism to Parameterized Modules}
% we need to make this section before Metatheory
% because a lot of our formulation in the metatheory
%   is inspired by the implementation
\label{sec:coqimpl}
\input{coqimpl.tex}

\section{\TT: A Core Dependent Type Theory}
\label{sec:metatheory2}
\input{metatheory-condensed.tex}


\section{Case Studies}
\label{sec:casestudies}
\input{casestudies.tex}

\section{Related Work}\label{sec:related-work}
\input{related-work.tex}

\section{Conclusion}
\label{sec:conclusion}

\input{conclusion.tex}

\setlength{\bibsep}{.8ex}
\bibliographystyle{tex-macros/ACM-Reference-Format.bst}
\bibliography{refs.bib}

\appendix

\section{Metatheory in (pseudo-)Agda}
We make four agda source code files (publicly and anonymously) openly avaliable, and they include the corresponding QIIT syntax definition and models. 

For syntax, please check \\ \href{https://drive.google.com/file/d/1aoG67rmXzP_x1MvZCIN3do0sucyqjwkn/view?usp=sharing}{https://drive.google.com/file/d/1aoG67rmXzP_x1MvZCIN3do0sucyqjwkn/view?usp=sharing}. This is done by mainly following the formulation \citet{altkap2016}. This is also very close to \citet{coquand2018canonicity} and \citet{sterling2019algebraic} but we formulate our syntax in a type-theoretic framework.

For syntactic translation, please check \\ \href{https://drive.google.com/file/d/1pMqn8DS4T4jiCubzk3HgMANjrfKpcGlI/view?usp=sharing}{https://drive.google.com/file/d/1pMqn8DS4T4jiCubzk3HgMANjrfKpcGlI/view?usp=sharing}. The syntactic translation here is to translate most of the novel feature introduced in this paper into a standard MLTT. 
The essence here is to translate linkage into a sigma type  with dependent function inside---and the dependent function is simulating the nature of ``late-binding'' of each field.


This is the first QIIT-model we give. A QIIT-model can be roughly consider as an arbitrary mapping from the QIIT data(our syntax in this case), also respecting the quotient(judgemental equality in this case). Here, the syntactic translation model is mapping to (a subpart of) the original QIIT data (itself). 

For consistency model, please check \\ \href{https://drive.google.com/file/d/1pNhnn125P5byAHDaSIlpbxMvr1F-9FRo/view?usp=sharing}{https://drive.google.com/file/d/1pNhnn125P5byAHDaSIlpbxMvr1F-9FRo/view?usp=sharing}. This is following the standard model from \citet{altkap2016,kaposi2017type,kaposi2019gluing}.

For canonicity model, please check \\ \href{https://drive.google.com/file/d/1R6C7QNfyu8fbl6LE2ruvpqZ_ZDSRVo0c/view?usp=sharing}{https://drive.google.com/file/d/1R6C7QNfyu8fbl6LE2ruvpqZ_ZDSRVo0c/view?usp=sharing}. This is mainly following \citet{coquand2018canonicity,sterling2019algebraic}, but we carried out our argument in a type-theortic framework.  In other references, it is also called reducibility argument, as an instance of proof-relevant logical relation. Our model can be considered as a verbose/more concrete version of \citet{kaposi2019gluing}.

For both consistency and canonicity model, the key part is still about handling the novel feature. Thanks to the insight from syntactic translation, we can always inspired by consistency and canonicity model of sigma type and dependent function in standard MLTT.

We suggest using editors with proper syntax highlighting, e.g. VSCode with agda-code plugins, to read these source files.

\section{Typing Rules in one Figure}
\include{all-typing-rule.tex}

\section{Metatheory, in detail}

\label{sec:metatheory}
\input{metatheory.tex}

\section{Example in Metatheory}\label{sec:coqexample}
\input{coq-example.tex}