\ifreport
    \ifblinded
        \documentclass[acmsmall,review,screen,nocopyrightspace]{acmart}
    \else
        \documentclass[acmsmall,screen,nocopyrightspace]{acmart}
    \fi
\else
    \iffinalformat
        \ifweb
            \typeout{>>> web distribution version}
            \documentclass[acmsmall,screen]{acmart}
        \else
            \typeout{>>> final conference version}
            \documentclass[acmsmall,screen]{acmart}
        \fi
    \else
        \ifblinded
            \documentclass[acmsmall,review,screen]{acmart}
            \pagestyle{plain}
        \else
            \documentclass[acmsmall,screen]{acmart}
        \fi
    \fi
\fi
%\citestyle{acmauthoryear}
\setcitestyle{nosort}

\usepackage{graphicx,eso-pic}
\usepackage[export]{adjustbox}
\usepackage{amsmath,stmaryrd,utf8math}
\usepackage[inline]{enumitem}
\usepackage[small]{ttquot}
\usepackage[T1]{fontenc} 
\usepackage{placeins,multirow,multicol}
\setlength\columnsep{19pt}
\usepackage{formalisms}
\usepackage{minted}
\usepackage{lipsum}
\usepackage{float}
\usepackage{microtype}
\usepackage{textpos}
\usepackage{stackengine}
\usepackage{tikz}
  \usetikzlibrary{calc}
  \tikzstyle{every lst line}=[line width=2pt, gray]
  % command for setting a TikZ anchor
  \newcommand{\tanc}[1]{%
      \begin{tikzpicture}[remember picture]
          \coordinate (#1) at (0,0);
%           \fill circle (0.5pt);% this line is for testing only
      \end{tikzpicture}%
  }
  % some parameters
  \def\DeltaX{39pt}
  \def\DeltaYi{6pt}
  \def\DeltaYii{-2pt}
  % command for drawing the lines
  \NewDocumentCommand{\makeline}{O{0pt} m m O{}}{%
      \begin{tikzpicture}[remember picture, overlay, transform canvas={xshift=#1}]
          \draw [every lst line,#4] %
              let\p1=(#2), \p2=(#3), \p3=(current page.west) in%
              (\x3+\DeltaX,\y1+\DeltaYi) -- (\x3+\DeltaX,\y2+\DeltaYii);
          ;
      \end{tikzpicture}%
  }
\usepackage[customcolors,shade]{hf-tikz}
\usetikzlibrary {arrows.meta}
\usepackage{wrapfig}
\BeforeBeginEnvironment{wrapfigure}{
    \setlength{\intextsep}{0.5ex}
    \setlength{\columnsep}{2.0ex}
}
\usepackage{pgfplots}
    \pgfplotsset{
        compat=1.17,
        label style={font=\scriptsize,inner sep=0pt},
        tick label style={font=\scriptsize},
        legend style={draw=none,font=\scriptsize},
    }

\usepackage[subrefformat=simple,labelformat=simple]{subcaption}
\renewcommand\thesubfigure{(\alph{subfigure})}
\captionsetup[figure]{
  name=Figure,
%  textfont={},
%  labelfont={small,sf,bf},
  labelsep=period,
  skip=\abovecaptionskip-1ex,
  belowskip=\belowcaptionskip-0ex,
}
\captionsetup[subfigure]{
  textfont={small,sf},
  labelfont={small,sf},
  skip=\abovecaptionskip-1.0ex,
  belowskip=\belowcaptionskip+0ex,
  position=bottom,
}

\usepackage{etoolbox}

\definecolor{faint-gray}{gray}{0.985}
\definecolor{light-gray}{gray}{0.75}
\definecolor{dark-gray}{gray}{0.25}
\definecolor{san-marino}{RGB}{68,108,179}
\definecolor{blue-gray}{HTML}{778ca3}
\definecolor{pomegranate}{RGB}{192,57,43}
\definecolor{pure-apple}{HTML}{6ab04c}
\definecolor{exodus-fruit}{HTML}{686de0}
\definecolor{middle-blue}{HTML}{7ED6DF}
\definecolor{soaring-eagle}{HTML}{95AFC0}
\definecolor{light-indigo}{HTML}{7158E2}
\definecolor{bright-lilac}{HTML}{CD84F1}
\definecolor{cream}{HTML}{FFFFCC}
\definecolor{confetti}{HTML}{E9D460}
\definecolor{malibu}{HTML}{6BB9F0}
\definecolor{chambray}{HTML}{3a539b}
\definecolor{scampi}{HTML}{736598}
\definecolor{studio}{HTML}{8e44ad}
\definecolor{salem}{HTML}{1e824c}

\newenvironment{centered}{%
  \centering
}{%
  \par
}

\usepackage{hyperref}
\hypersetup{
  colorlinks,
  urlcolor=black,
  citecolor=black,
  filecolor=black
  linkcolor=black,
}
\numberwithin{equation}{section}
\usepackage{cleveref}
\crefformat{section}{\mbox{Section #2#1#3}}
\crefformat{appendix}{\mbox{Appendix #2#1#3}}
\crefformat{subsection}{\mbox{Section #2#1#3}}
\crefrangeformat{section}{\mbox{Sections #3#1#4--#5#2#6}}
\crefrangeformat{appendix}{\mbox{Appendices #3#1#4--#5#2#6}}
\crefrangeformat{subsection}{\mbox{Sections #3#1#4--#5#2#6}}
\crefrangeformat{subsubsection}{\mbox{Sections #3#1#4--#5#2#6}}
\crefmultiformat{section}{\mbox{Sections #2#1#3}}{ and \mbox{#2#1#3}}
{, \mbox{#2#1#3}}{, and \mbox{#2#1#3}}
\crefmultiformat{appendix}{\mbox{Appendices #2#1#3}}{ and \mbox{#2#1#3}}
{, \mbox{#2#1#3}}{, and \mbox{#2#1#3}}
\crefmultiformat{subsection}{\mbox{Sections #2#1#3}}{ and \mbox{#2#1#3}}
{, \mbox{#2#1#3}}{, and \mbox{#2#1#3}}
\crefmultiformat{subsubsection}{\mbox{Sections #2#1#3}}{ and \mbox{#2#1#3}}
{, \mbox{#2#1#3}}{, and \mbox{#2#1#3}}
% \crefformat{section}{\mbox{§#2#1#3}}
% \crefformat{appendix}{\mbox{§#2#1#3}}
% \crefformat{subsection}{\mbox{§#2#1#3}}
% \crefrangeformat{section}{\mbox{§#3#1#4--#5#2#6}}
% \crefrangeformat{appendix}{\mbox{§#3#1#4--#5#2#6}}
% \crefrangeformat{subsection}{\mbox{§#3#1#4--#5#2#6}}
% \crefrangeformat{subsubsection}{\mbox{§#3#1#4--#5#2#6}}
% \crefmultiformat{section}{\mbox{§#2#1#3}}{ and §\mbox{#2#1#3}}
% {, §\mbox{#2#1#3}}{, and §\mbox{#2#1#3}}
% \crefmultiformat{appendix}{\mbox{§#2#1#3}}{ and §\mbox{#2#1#3}}
% {, §\mbox{#2#1#3}}{, and §\mbox{#2#1#3}}
% \crefmultiformat{subsection}{\mbox{§#2#1#3}}{ and §\mbox{#2#1#3}}
% {, §\mbox{#2#1#3}}{, and §\mbox{#2#1#3}}
% \crefmultiformat{subsubsection}{\mbox{§#2#1#3}}{ and §\mbox{#2#1#3}}
% {, §\mbox{#2#1#3}}{, and §\mbox{#2#1#3}}

  \crefname{table}{Table}{Table}

  \crefformat{figure}{Figure~#2#1#3}
  \crefrangeformat{figure}{\mbox{Figures #3#1#4--#5#2#6}}
  \crefmultiformat{figure}{\mbox{Figures #2#1#3}}{ and \mbox{#2#1#3}}
  {, \mbox{#2#1#3}}{, and \mbox{#2#1#3}}

  \crefformat{equation}{(#2#1#3)}
  \crefrangeformat{equation}{\mbox{(#1)--(#2)}}

%\usepackage{formalisms/formalisms}

\ifshowcomments
    \usepackage[checkNoComments]{aplcomments}
\else
    \usepackage[disabled]{aplcomments}
\fi

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{ltblue}{rgb}{0,0.4,0.4}
\definecolor{dkviolet}{rgb}{0.54,0.17,0.89}
\definecolor{dkblue}{rgb}{0.0,0.53,0.74}
\definecolor{dkred}{rgb}{0.76,0.13,0.28}

\definecolor{keyword-color}{HTML}{4E6C9D}
\definecolor{keyword-color-1}{HTML}{9465B6}
\definecolor{keyword-color-2}{HTML}{9465B6}
%\definecolor{idcolor}{HTML}{000000}
\colorlet{codecomment-color}{dkgreen}
\colorlet{string-color}{gray}

\usepackage{listings,lstautogobble}
\def\lsti{\lstinline}
\lstdefinelanguage{Coq}{
  % Anything betweeen $ becomes LaTeX math mode
  mathescape=true,
  % Comments may or not include Latex commands
  texcl=false, 
  % Vernacular commands
  morekeywords=[1]{Section, Module, End, Require, Import, Export,
      Variable, Variables, Parameter, Parameters, Axiom, Hypothesis,
      Hypotheses, Notation, Local, Tactic, Reserved, Scope, Open, Close,
      Bind, Delimit, Definition, Let, Ltac, Fixpoint, CoFixpoint, Add,
      Morphism, Relation, Implicit, Arguments, Unset, Contextual,
      Strict, Prenex, Implicits, Inductive, CoInductive, Record,
      Structure, Canonical, Coercion, Context, Class, Global, Instance,
      Program, Infix, Theorem, Lemma, Corollary, Proposition, Fact,
      Remark, Example, Proof, Goal, Save, Qed, Defined, Admitted, Hint, Resolve,
      Rewrite, View, Search, Show, Print, Printing, All, Eval, Check,
      Projections, inside, outside, Def, Include, Type, Prop, Set,
      % For Family Poly
      Family, extends, using, FInductive, FRecursion, FInduction,
      Case, FTheorem, FLemma, FDefinition, MetaData, EndMetaData, Closing, Final, Inherit,
      },
  % Gallina
  morekeywords=[2]{forall, exists, exists2, fun, fix, cofix, struct,
      match, with, end, as, in, return, let, if, is, then, else, for, of,
      nosimpl, when,
      },
  % Gallina: Family Poly
  morekeywords=[3]{on, motive, Overridable, self},
  % Sorts
  morekeywords=[4]{true, false, option},
  % Various tactics, some are std Coq subsumed by ssr, for the manual purpose
  morekeywords=[5]{pose, set, move, case, elim, apply, clear, hnf,
      intro, intros, generalize, rename, pattern, after, destruct,
      induction, refine, inversion, injection, discriminate, rewrite, congr,
      unlock, compute, ring, field, fourier, replace, fold, unfold,
      change, cutrewrite, simpl, have, suff, wlog, suffices, without,
      loss, nat_norm, assert, cut, trivial, revert, bool_congr, nat_congr,
      symmetry, transitivity, auto, split, left, right, autorewrite,
      % Family Poly
      fsimpl, fdiscriminate, finjection},
  % Terminators
  morekeywords=[6]{by, done, exact, reflexivity, tauto, romega, omega,
      assumption, solve, contradiction},
  % Control
  morekeywords=[7]{do, last, first, try, idtac, repeat},
  % Comments delimiters, we do turn this off for the manual
  morecomment=[s]{(*}{*)},
  % Spaces are not displayed as a special character
  showstringspaces=false,
  % String delimiters
  morestring=[b]",
  morestring=[d],
  % Size of tabulations
  tabsize=2,
  % Enables ASCII chars 128 to 255
  extendedchars=false,
  % Case sensitivity
  sensitive=true,
  % Automatic breaking of long lines
  breaklines=false,
  % Default style fors listings
  basicstyle=\small\ttfamily,
  % Position of captions is bottom
  captionpos=b,
  % flexible columns
  columns=[l]flexible,
  % Style for (listings') identifiers
  identifierstyle={\ttfamily\color{black}},
  % Style for declaration keywords
  keywordstyle=[1]{\ttfamily\color{dkviolet}},
  % Style for gallina family poly keywords
  keywordstyle=[2]{\ttfamily\color{violet}},
  % Style for gallina keywords
  keywordstyle=[3]{\ttfamily\color{blue}},
  % Style for sorts keywords
  keywordstyle=[4]{\ttfamily\color{ltblue}},
  % Style for tactics keywords
  keywordstyle=[5]{\ttfamily\color{dkblue}},
  % Style for terminators keywords
  keywordstyle=[6]{\ttfamily\color{orange}},
  %Style for iterators
  %keywordstyle=[6]{\ttfamily\color{dkpink}},
  % Style for strings
  stringstyle=\ttfamily\color{string-color},
  % Style for comments
  commentstyle={\rmfamily\itshape\color{codecomment-color}},
  %moredelim=**[is][\ttfamily\color{red}]{/&}{&/},
  literate=
  {\\forall}{{\color{violet}{$\forall$}}}1
  {\\exists}{{\color{violet}{$\exists$}}}1
  {\\neg}{{\color{violet}{$\neg$}}}1
  {\\lambda}{{\color{violet}{$\lambda$}}}1
  {\\alpha}{{\color{black}{$\alpha$}}}1
  {\\nat}{{\color{black}{$\mathbb{N}$}}}1
  {\\_}{{\color{black}{$°$}}}1
  {:=}{{\color{blue}$\coloneqq$}}1
  {+=}{{\color{blue}$\mathrel{{+}{=}}$}}1
  {<-}{{$\leftarrow$}}1
  {=>}{{$\Rightarrow$}}1
  {==}{{\code{==}}}1
  {==>}{{\code{==>}}}1
  %    {:>}{{\code{:>}}}1
  {->}{{$\rightarrow$}}1
  {<->}{{$\leftrightarrow$}}1
  {<==}{{$\leq$}}1
  {\#}{{$^\star$}}1 
  {\\o}{{$\circ$}}1 
  {\@}{{$\cdot$}}1 
  {\/\\}{{$\wedge$}}1
  {\\\/}{{$\vee$}}1
  {++}{{\code{++}}}1
  {~}{{\ }}1
  {\@\@}{{$@$}}1
  {\\mapsto}{{$\mapsto$}}1
  {\\hline}{{\rule{\linewidth}{0.5pt}}}1
  %
}[keywords,comments,strings]
  \lstset{autogobble=true}
  \lstset{language={Coq}}
  \lstset{escapeinside={[@}{@]}}
  \lstset{
%   backgroundcolor=\color{faint-gray},
%   frame=tlbr,
%   framesep=3pt,
%   framerule=.4pt,
%   rulecolor=\color{black},
  }
  \lstset{
    numbersep=2.0ex,
    numberstyle=\color{gray}\tiny\itshape,
    numberblanklines=true,
    numbers=none,
  }
  \lstset{lineskip=0pt}
  \lstset{keepspaces=true,xleftmargin=0ex}
% \lstset{tabsize=2}
% \lstset{columns=fullflexible}
% \lstset{basicstyle=
%   \fontsize{9.3}{9.9}
%   \color{keyword-color}
%   \ttfamily%\rmfamily
% }
% \lstset{commentstyle=\color{codecomment-color}\rmfamily\itshape}
% \lstset{stringstyle=\color{string-color}}
% \lstset{identifierstyle=\color{black}\itshape}
% \lstset{deletekeywords={val,fun,end}}
% \lstset{morekeywords={module,mixin,extends,def,effect,raises,raise,handle,→,⇒,int,bool,unit,string}}
% \lstset{keywordstyle=\bfseries\color{keyword-color}}
% \lstset{showstringspaces=false}
% \lstset{breaklines=\lst@ifdisplaystyle false \else true \fi}
  \let\origthelstnumber\thelstnumber
  \makeatletter
  \newcommand*\Suppressnumber{%
    \lst@AddToHook{OnNewLine}{%
      \let\thelstnumber\relax%
       \advance\c@lstnumber-\@ne\relax%
      }%
  }
  \newcommand*\Reactivatenumber{%
    \lst@AddToHook{OnNewLine}{%
     \let\thelstnumber\origthelstnumber%
     \advance\c@lstnumber\@ne\relax}%
  }
\makeatother

\newcommand\codecomment[1]{%
  {\color{codecomment-color}\textls[-50]{\texttt{(*}}\rmfamily\itshape\;#1\;\textls[-50]{\texttt{*)}}}%
}
\newcommand\codecommentstart[1]{%
  {\color{codecomment-color}\textls[-50]{\texttt{(*}}\rmfamily\itshape\;#1}%
}
\newcommand\codecommentend[1]{%
  {\color{codecomment-color}\rmfamily\itshape#1\;\textls[-50]{\texttt{*)}}}%
}
\newcommand\codecommentmid[1]{%
  {\color{codecomment-color}\rmfamily\itshape#1}%
}
\newcommand\codestring[1]{%
  \color{dark-gray}%
  \textquotedbl#1\textquotedbl
}
\definecolor{codeemph-color}{HTML}{ECF5F8}
\newcommand\codeemph[2][]{%
  \ifthenelse{\isempty{#1}}{%
    \colorlet{color}{black}%
  }{%
    \colorlet{color}{#1}%
  }%
  \setlength\fboxsep{1pt}\colorbox{codeemph-color}{\textcolor{color}{\mbox{#2}}}%
}

\newcommand{\dadada}{\textnormal{\textcolor{gray}{...}}}

\newcommand{\citea}[1]{\citeauthor{#1}}
\newcommand{\citelink}[2]{\hyperlink{cite.#1}{#2}\xspace}

\makeatletter
%  \renewcommand\@secfont{\bfseries\sffamily\section@raggedright\MakeTextUppercase}
%  \renewcommand\@subsecfont{\bfseries\sffamily}
%  \renewcommand\@subsubsecfont{\bfseries\sffamily}
  \renewcommand\@parfont{\bfseries\itshape}
  \renewcommand\paragraph{\@startsection{paragraph}{4}{\z@}%\parindent}%
  {-.5\baselineskip \@plus -.8\p@ \@minus -.2\p@}%
  {-3.5\p@}%
  {\ACM@NRadjust{\@parfont\@adddotafter}}}
\makeatother

\renewcommand{\floatpagefraction}{0.75}
\renewcommand{\dblfloatpagefraction}{0.75}

\input{title}

% Note: the .blinded file affects whether blinding happens
\ifblinded
\else
    \author{Ende Jin}
    \affiliation{
        \institution{University of Waterloo}
        \country{Canada}
    }
    \author{Yizhou Zhang}
    \affiliation{
        \institution{University of Waterloo}
        \country{Canada}
    }
\fi
\authorsaddresses{}

\ifcopyrightspace
%    \setcopyright{acmcopyright}
%    \settopmatter{printacmref=true}
\else
    \setcopyright{none}
    \renewcommand\footnotetextcopyrightpermission[1]{}
    \settopmatter{printacmref=false}
\fi

\ifwarning
\AtBeginDocument{
 \AddToShipoutPicture*{\put(418,750){\it\color{red}{\fbox{\large Draft---please do not distribute}}}}
}
\fi

\newsavebox\crunchedbox
\def\vcrunch#1{\savebox\crunchedbox{#1}\smash{\usebox\crunchedbox}{\vrule width 0pt height 0.9em}}

\newcommand\FIXME{\colorbox{pomegranate}{\color{white}\texttt{??}}}
\newcommand\TODO{\colorbox{pure-apple}{\color{white}\texttt{TODO}}}

\makeatletter
\newcommand{\textlabel}[2]{%
  \edef\@currentlabel{#1}% Set target label
  #1\phantomsection% Correct hyper reference link
  \label{#2}% Print and store label
}
\newcommand{\headinglabel}[2]{%
  \edef\@currentlabel{#1}% Set target label
  #1% Correct hyper reference link
  \label{#2}% Print and store label
}
\makeatother

\newif\ifShowOldWriting% Hide EDJ's old writing?
%\ShowOldWritingtrue
