\ifreport
    \ifblinded
        \documentclass[acmsmall,review,screen,nocopyrightspace]{acmart}
    \else
        \documentclass[acmsmall,screen,nocopyrightspace]{acmart}
    \fi
\else
    \iffinalformat
        \ifweb
            \typeout{>>> web distribution version}
            \documentclass[acmsmall,screen]{acmart}
        \else
            \typeout{>>> final conference version}
            \documentclass[acmsmall,screen]{acmart}
        \fi
    \else
        \ifblinded
            \documentclass[acmsmall,review,screen]{acmart}
            \pagestyle{plain}
        \else
            \documentclass[acmsmall,screen]{acmart}
        \fi
    \fi
\fi
%\citestyle{acmauthoryear}
\setcitestyle{nosort}

\usepackage{graphicx,eso-pic}
\usepackage[export]{adjustbox}
\usepackage{amsmath,stmaryrd,utf8math}
\usepackage[inline]{enumitem}
\usepackage{ttquot}
\usepackage[T1]{fontenc} 
\usepackage{placeins,multirow,multicol}
\usepackage{formalisms}
\usepackage{minted}
\usepackage{lipsum}
\usepackage{float}
\usepackage{microtype}
\usepackage{textpos}
\usepackage{stackengine}
\usepackage[customcolors,shade]{hf-tikz}
\usetikzlibrary {arrows.meta}
\usepackage{wrapfig}
\BeforeBeginEnvironment{wrapfigure}{
    \setlength{\intextsep}{0.5ex}
    \setlength{\columnsep}{2.0ex}
}
\usepackage{pgfplots}
    \pgfplotsset{
        compat=1.17,
        label style={font=\scriptsize,inner sep=0pt},
        tick label style={font=\scriptsize},
        legend style={draw=none,font=\scriptsize},
    }

\usepackage[subrefformat=simple,labelformat=simple]{subcaption}
\renewcommand\thesubfigure{(\alph{subfigure})}
\captionsetup[figure]{
  name=Figure,
%  textfont={},
%  labelfont={small,sf,bf},
  labelsep=period,
  skip=\abovecaptionskip-1ex,
  belowskip=\belowcaptionskip-0ex,
}
\captionsetup[subfigure]{
  textfont={small,sf},
  labelfont={small,sf},
  skip=\abovecaptionskip-1.0ex,
  belowskip=\belowcaptionskip+0ex,
  position=bottom,
}

\usepackage{etoolbox}

\definecolor{faint-gray}{gray}{0.985}
\definecolor{light-gray}{gray}{0.75}
\definecolor{dark-gray}{gray}{0.25}
\definecolor{san-marino}{RGB}{68,108,179}
\definecolor{blue-gray}{HTML}{778ca3}
\definecolor{pomegranate}{RGB}{192,57,43}
\definecolor{pure-apple}{HTML}{6ab04c}
\definecolor{exodus-fruit}{HTML}{686de0}
\definecolor{middle-blue}{HTML}{7ED6DF}
\definecolor{soaring-eagle}{HTML}{95AFC0}
\definecolor{light-indigo}{HTML}{7158E2}
\definecolor{bright-lilac}{HTML}{CD84F1}
\definecolor{cream}{HTML}{FFFFCC}
\definecolor{confetti}{HTML}{E9D460}
\definecolor{malibu}{HTML}{6BB9F0}
\definecolor{chambray}{HTML}{3a539b}
\definecolor{scampi}{HTML}{736598}
\definecolor{studio}{HTML}{8e44ad}
\definecolor{salem}{HTML}{1e824c}

\newenvironment{centered}{%
  \centering
}{%
  \par
}

\usepackage{hyperref}
\hypersetup{
  colorlinks,
  urlcolor=black,
  citecolor=black,
  filecolor=black
  linkcolor=black,
}
\numberwithin{equation}{section}
\usepackage{cleveref}
\crefformat{section}{\mbox{Section #2#1#3}}
\crefformat{appendix}{\mbox{Appendix #2#1#3}}
\crefformat{subsection}{\mbox{Section #2#1#3}}
\crefrangeformat{section}{\mbox{Sections #3#1#4--#5#2#6}}
\crefrangeformat{appendix}{\mbox{Appendices #3#1#4--#5#2#6}}
\crefrangeformat{subsection}{\mbox{Sections #3#1#4--#5#2#6}}
\crefrangeformat{subsubsection}{\mbox{Sections #3#1#4--#5#2#6}}
\crefmultiformat{section}{\mbox{Sections #2#1#3}}{ and \mbox{#2#1#3}}
{, \mbox{#2#1#3}}{, and \mbox{#2#1#3}}
\crefmultiformat{appendix}{\mbox{Appendices #2#1#3}}{ and \mbox{#2#1#3}}
{, \mbox{#2#1#3}}{, and \mbox{#2#1#3}}
\crefmultiformat{subsection}{\mbox{Sections #2#1#3}}{ and \mbox{#2#1#3}}
{, \mbox{#2#1#3}}{, and \mbox{#2#1#3}}
\crefmultiformat{subsubsection}{\mbox{Sections #2#1#3}}{ and \mbox{#2#1#3}}
{, \mbox{#2#1#3}}{, and \mbox{#2#1#3}}
% \crefformat{section}{\mbox{§#2#1#3}}
% \crefformat{appendix}{\mbox{§#2#1#3}}
% \crefformat{subsection}{\mbox{§#2#1#3}}
% \crefrangeformat{section}{\mbox{§#3#1#4--#5#2#6}}
% \crefrangeformat{appendix}{\mbox{§#3#1#4--#5#2#6}}
% \crefrangeformat{subsection}{\mbox{§#3#1#4--#5#2#6}}
% \crefrangeformat{subsubsection}{\mbox{§#3#1#4--#5#2#6}}
% \crefmultiformat{section}{\mbox{§#2#1#3}}{ and §\mbox{#2#1#3}}
% {, §\mbox{#2#1#3}}{, and §\mbox{#2#1#3}}
% \crefmultiformat{appendix}{\mbox{§#2#1#3}}{ and §\mbox{#2#1#3}}
% {, §\mbox{#2#1#3}}{, and §\mbox{#2#1#3}}
% \crefmultiformat{subsection}{\mbox{§#2#1#3}}{ and §\mbox{#2#1#3}}
% {, §\mbox{#2#1#3}}{, and §\mbox{#2#1#3}}
% \crefmultiformat{subsubsection}{\mbox{§#2#1#3}}{ and §\mbox{#2#1#3}}
% {, §\mbox{#2#1#3}}{, and §\mbox{#2#1#3}}

  \crefname{table}{Table}{Table}

  \crefformat{figure}{Figure~#2#1#3}
  \crefrangeformat{figure}{\mbox{Figures #3#1#4--#5#2#6}}
  \crefmultiformat{figure}{\mbox{Figures #2#1#3}}{ and \mbox{#2#1#3}}
  {, \mbox{#2#1#3}}{, and \mbox{#2#1#3}}

  \crefformat{equation}{(#2#1#3)}
  \crefrangeformat{equation}{\mbox{(#1)--(#2)}}

%\usepackage{formalisms/formalisms}

\ifshowcomments
    \usepackage[checkNoComments]{aplcomments}
\else
    \usepackage[disabled]{aplcomments}
\fi

\definecolor{keyword-color}{HTML}{4E6C9D}
\definecolor{keyword-color-1}{HTML}{9465B6}
\definecolor{keyword-color-2}{HTML}{9465B6}
%\definecolor{idcolor}{HTML}{000000}
\definecolor{codecomment-color}{HTML}{AA99CC}
\colorlet{string-color}{gray}
\usepackage{listings,lstautogobble}
  \lstset{autogobble=true}
  \lstset{language={[Objective]Caml}}
  \lstset{tabsize=2}
  \lstset{escapeinside={[@}{@]}}
  \lstset{
%    backgroundcolor=\color{faint-gray},
%    frame=tlbr,
%    framesep=2pt,
%    framerule=.4pt,
%    rulecolor=\color{black},
  }
  \lstset{
    numbersep=1.2ex,
    numberstyle=\color{gray}\scriptsize\itshape\ttfamily,
    numberblanklines=true,
    numbers=none,
  }
  \lstset{lineskip=.2ex}
  \lstset{tabsize=2}
  \lstset{columns=fullflexible}
  \lstset{basicstyle=
    \fontsize{9.3}{9.9}
    \color{keyword-color}
    \ttfamily%\rmfamily
  }
  \lstset{commentstyle=\color{codecomment-color}\rmfamily\itshape}
  \lstset{stringstyle=\color{string-color}}
  \lstset{identifierstyle=\color{black}\itshape}
  \lstset{keepspaces=true,xleftmargin=0ex,breaklines=false}
  \lstset{deletekeywords={val,fun,end}}
  \lstset{morekeywords={module,mixin,extends,def,effect,raises,raise,handle,→,⇒,int,bool,unit,string}}
  \lstset{keywordstyle=\bfseries\color{keyword-color}}
  \lstset{
    classoffset=1,% starting new class
    morekeywords={},
    keywordstyle=\color{keyword-color-1},
    classoffset=0,
    classoffset=2,% starting new class
    morekeywords={},
    keywordstyle=\color{keyword-color-2},
    classoffset=0,
  }
  \lstset{showstringspaces=false}
  \lstset{breaklines=\lst@ifdisplaystyle false \else true \fi}
  \let\origthelstnumber\thelstnumber
  \makeatletter
  \newcommand*\Suppressnumber{%
    \lst@AddToHook{OnNewLine}{%
      \let\thelstnumber\relax%
       \advance\c@lstnumber-\@ne\relax%
      }%
  }
  \newcommand*\Reactivatenumber{%
    \lst@AddToHook{OnNewLine}{%
     \let\thelstnumber\origthelstnumber%
     \advance\c@lstnumber\@ne\relax}%
  }
\makeatother

\newcommand\codecomment[1]{%
  \color{codecomment-color}%
  \textrm{\itshape//~#1}
}
\newcommand\codecommentinline[1]{%
  \color{codecomment-color}%
  \textrm{\itshape/$*$~{#1}~$*$/}%
}
\newcommand\codestring[1]{%
  \color{dark-gray}%
  \textquotedbl#1\textquotedbl
}
\definecolor{codeemph-color}{HTML}{ECF5F8}
\newcommand\codeemph[2][]{%
  \ifthenelse{\isempty{#1}}{%
    \colorlet{color}{black}%
  }{%
    \colorlet{color}{#1}%
  }%
  \setlength\fboxsep{1pt}\colorbox{codeemph-color}{\textcolor{color}{\mbox{#2}}}%
}

\newcommand{\dadada}{\textnormal{\textcolor{black}{...}}}

\newcommand{\citea}[1]{\citeauthor{#1}}
\newcommand{\citelink}[2]{\hyperlink{cite.#1}{#2}\xspace}

\makeatletter
%  \renewcommand\@secfont{\bfseries\sffamily\section@raggedright\MakeTextUppercase}
%  \renewcommand\@subsecfont{\bfseries\sffamily}
%  \renewcommand\@subsubsecfont{\bfseries\sffamily}
  \renewcommand\@parfont{\bfseries\itshape}
  \renewcommand\paragraph{\@startsection{paragraph}{4}{\z@}%\parindent}%
  {-.5\baselineskip \@plus -.8\p@ \@minus -.2\p@}%
  {-3.5\p@}%
  {\ACM@NRadjust{\@parfont\@adddotafter}}}
\makeatother

\renewcommand{\floatpagefraction}{0.75}
\renewcommand{\dblfloatpagefraction}{0.75}

\input{title}

% Note: the .blinded file affects whether blinding happens
\ifblinded
\else
    \author{Ende Jin}
    \affiliation{
        \institution{University of Waterloo}
        \country{Canada}
    }
    \author{Yizhou Zhang}
    \affiliation{
        \institution{University of Waterloo}
        \country{Canada}
    }
\fi
\authorsaddresses{}

\ifcopyrightspace
%    \setcopyright{acmcopyright}
%    \settopmatter{printacmref=true}
\else
    \setcopyright{none}
    \renewcommand\footnotetextcopyrightpermission[1]{}
    \settopmatter{printacmref=false}
\fi

\ifwarning
\AtBeginDocument{
 \AddToShipoutPicture*{\put(418,750){\it\color{red}{\fbox{\large Draft---please do not distribute}}}}
}
\fi

\newsavebox\crunchedbox
\def\vcrunch#1{\savebox\crunchedbox{#1}\smash{\usebox\crunchedbox}{\vrule width 0pt height 0.9em}}

\newcommand\FIXME{\colorbox{pomegranate}{\color{white}\texttt{??}}}
\newcommand\TODO{\colorbox{pure-apple}{\color{white}\texttt{TODO}}}

\makeatletter
\newcommand*{\textlabel}[2]{%
  \edef\@currentlabel{#1}% Set target label
  \phantomsection% Correct hyper reference link
  #1\label{#2}% Print and store label
}
\makeatother