\judgebox{\goodCtx{\Gm}{i}}
$$ 
\Rule[name=Empty Context]{}{\goodCtx{\cdot}{0}} 
\quad
\Rule[name=Context Extension]
{\goodCtx{\Gm}{i} \quad \goodType{\Gm}{A}{j}}
{\goodCtx{\Gm, A}{i \cup j}}  
$$


\judgebox{ \goodType{\Gm}{T}{i} }
$$
\Rule[name=Type Universe]
{}
{\goodType{\Gm}{\cU}{j + 1}}
\quad 
\Rule[name=Boolean]
{}
{\goodType{\Gm}{\cB}{0}}
\quad 
\Rule[name=Bottom]
{}
{\goodType{\Gm}{\bot}{0}}
\quad 
\Rule[name=Function]
{\goodType{\Gm}{A}{j} 
  \quad \goodType{\Gm, A}{B}{k}}
{\goodType{\Gm}{\TyPi{A}{B}}{j \cup k}}
$$

$$
\quad 
\Rule[name=Func/DPair Subst]
{\goodSub{\Gm}{\gm}{\Delta}
\quad \goodType{\Delta}{A}{} 
\quad \goodType{\Delta, A}{B}{}
}
{
  \goodType{\Gm}{ \sub{(\TyPi {A} {B})}{\gm} \equiv \TyPi {\sub{A}{\gm}} {\sub{B}{\gm^\uparrow}} }{j \cup k}
  \quad 
  \goodType{\Gm}{ \sub{(\Sigma A B)}{\gm} \equiv \Sigma \sub{A}{\gm} \sub{B}{\gm^\uparrow} }{j \cup k}
}
$$

$$
\Rule[name=Type Subst]
{\goodType{\Delta}{T}{j} 
  \quad {\goodSub{\Gm}{\gm}{\Delta}}}
{\goodType{\Gm}{\sub{T}{\gm}}{j}}
\quad
\Rule[name=Base Type Subst]
{\goodSub{\Gm}{\gm}{\Delta}}
{\goodType{\Gm}{\sub{\cU}{\gm} \equiv \cU }{j + 1} \quad
  \goodType{\Gm}{\sub{\cB}{\gm} \equiv \cB}{0} \quad 
  \goodType{\Gm}{ \sub{\bot}{\gm} \equiv \bot}{0}
}
$$
\judgebox{ \goodTerm{\Gm}{t}{T} }
$$
\Rule[name=Code/Get Type]
{\goodType{\Gm}{T}{j}}
{\goodTerm{\Gm}{"c" \ T}{\cU}
}\quad
\Rule[]
{\goodTerm{\Gm}{T}{\cU}}
{\goodType{\Gm}{\El{T}}{j}}
\quad 
\Rule[name=Term Subst]
{\goodTerm{\Delta}{t}{T}
  \quad {\goodSub{\Gm}{\gm}{\Delta}}}
{\goodTerm{\Gm}{ \sub{t}{\gm}}{ \sub{T}{\gm} }}
$$
$$
\Rule[]
{\goodTerm{\Gm, A}{t}{B}}
{\goodTerm{\Gm}{\lambda t}{\TyPi {A} {B}}}
\quad 
\Rule[]
{\goodTerm{\Gm}{t}{\TyPi {A} {B}}}
{\goodTerm{\Gm, A}{"app"~t}{B}}
\quad 
\Rule[]
{\goodTerm{\Gm}{u}{A} 
\quad \goodTerm{\Gm}{v}{B[(id, u)]}}
{\goodTerm{\Gm}{(u,v)}{\Sigma A B}}
\quad 
\Rule[name=Sigma Elim]
{\goodTerm{\Gm}{t}{\Sigma A B}}
{\goodTerm{\Gm}{"pjl" \ t}{A}
\\\\ \goodTerm{\Gm}{"pjr" \  t}{B[(id, "pjl" \  t)]}
}
$$
$$
\Rule
{}
{\goodTerm{\Gm}{ \sub{(\lambda t)}{\gm} \equiv \lambda (\sub{t}{\gm^\uparrow})}{\TyPi {A} {B}}
\quad \goodTerm{\Gm}{ \sub{(u,v)}{\gm} \equiv (\sub{u}{\gm},\sub{v}{\gm})}{\Sigma A B}
\quad \goodType{\Gm}{\El{(\sub{T}{\gm})} \equiv \sub{(\El{T})}{\gm}}{}
}
$$

$$
\Rule[name=Bool]
{}
{\goodTerm{\Gm}{\true, \false}{\cB}}
\quad
\Rule[]
{\goodSub{\Gm}{\gm}{\Delta}}
{\goodType{\Gm}{ \sub{(\El{T})}{\gm} \equiv \El{(\sub{T}{\gm})} }{j} \quad
 \goodTerm{\Gm}{ \sub{\true}{\gm} \equiv \true}{\cB} \quad 
 \goodTerm{\Gm}{ \sub{\false}{\gm} \equiv \false}{\cB} 
}
$$
\judgebox{\goodSub{\Gm}{\sigma}{\Delta}}
$$
\Rule[name=Ept Subst]
{}{\goodSub{\Gm}{\epsilon}{\cdot}}
\quad
\Rule[]
{}{\goodSub{\Gm}{"id"}{\Gm}}
\quad
\Rule[name=Sub Comp]{
  \goodSub{\Delta}{\delta}{\Theta}
  \quad \goodSub{\Gm}{\gm}{\Delta} 
}{\goodSub{\Gm}{\delta \circ \gm}{\Theta}}
\Rule[name=Sub Extend]
{\goodSub{\Gm}{\gm}{\Delta} \quad \goodTerm{\Gm}{t}{ \sub{A}{\gm}}}
{\goodSub{\Gm}{(\gm, t)}{(\Delta, A)}}
$$

$$
\Rule[name=Proj Subst-1]
{\goodSub{\Gm}{\gm}{(\Delta, A)}}
{\goodSub{\Gm}{\pi_1 \gm}{\Delta}}
\quad
\Rule[name=Proj Subst-2]
{\goodSub{\Gm}{\gm}{(\Delta, A)}}
{\goodSub{\Gm}{\pi_2 \gm}{ \sub{A}{\pi_1 \gm}}}
\quad
\Rule[name=Proj-Ext]
{}
{\goodSub{\Gm}{(\pi_1 \gm, \pi_2 \gm) \equiv \gm}{\Delta}}
$$



\judgebox{\goodWSig{\Gm}{\wsig}{n}}
$$
\Rule[name=Emp-WSig]
{}
{\goodWSig{\Gm}{w\cdot}{0}}
\quad
\Rule[name=WSig-Add]
{\goodWSig{\Gm}{\wsig}{n}
  \quad \goodType{\Gm}{A}{i}
  \quad \goodType{\Gm, A}{B}{i}}
{\goodWSig{\Gm}{w^+ \  \wsig \  A \  B}{n+1}}
\quad
\Rule[name=Ind-Univ]
{\goodWSig{\Gm}{\wsig}{n}}
{\goodType{\Gm}{\bW \wsig}{i}
}
$$

$$
\Rule[name=WSig-Proj]
{\goodWSig{\Gm}{\wsig}{n} \quad j < n}
{\goodType{\Gm}{\wsigproj{j}{1}{\wsig} }{i} \quad \goodType{\Gm, \wsigproj{j}{1}{\wsig}}{\wsigproj{j}{2}{\wsig}}{i}}
\quad
\Rule[name=Ind-Sig]
{\goodWSig{\Delta}{\wsig}{n}
  \quad {\goodSub{\Gm}{\gm}{\Delta}}}
{\goodWSig{\Gm}{ \sub{\wsig}{\gm}}{n}
  \quad \goodType{\Gm}{W ( \sub{\wsig}{\gm}) \equiv \sub{(W \wsig)}{\gm}}{i}}
$$

$$
\Rule[name=Ind-Type]
{\goodWSig{\Gm}{\wsig}{n}}
{\goodTerm{\Gm}{\wcode{\wsig}}{\cU}
}
\quad 
\Rule[]{}{\goodTerm{\Gm}{\star_\wsig}{\bW \wsig}}
\quad
\Rule[name=Ind-Term]
{{\goodWSig{\Gm}{\wsig}{n}}
  \quad \goodTerm{\Gm}{a}{\wsigproj{j}{1}{\wsig}}
  \quad \goodTerm{\Gm, \sub{\wsigproj{j}{2}{\wsig}}{(id, a)}}{b}{\El{(\wcode{\wsig})}}}
{\goodTerm{\Gm}{"Wsup"~T~a~b}{\El{(\wcode{\wsig})}} }
$$


\judgebox{\goodSig{\Gm}{\sigma}{n} }
$$
\Rule[name=Lnkg Type/Compile]
{\goodSig{\Gm}{\sigma}{n}}
{\goodType{\Gm}{\TyLkg{\sigma}}{i}
\quad \goodType{\Gm}{\cC \sigma}{}}
\quad
\Rule[name=Sig/Lnkg Subst]
{\goodSig{\Delta}{\sigma}{n}
  \quad {\goodSub{\Gm}{\gm}{\Delta}}}
{\goodSig{\Gm}{ \sub {\sigma}{\gm}}{n}
  \quad \goodType{\Gm}{\TyLkg{ \sub{\sigma}{\gm}} \equiv \sub{(\TyLkg{\sigma})}{\gm}}{i}}
$$

$$
\Rule[name=Ept Sig]
{}
{\goodSig{\Gm}{\nu\cdot}{0}}
\quad
\Rule[name=Sig Add]
{\goodSig{\Gm}{\sigma}{n} 
 \quad \goodType{\Gm}{A}{}
 \quad \goodSeal{\Gm}{f}{\sigma}{A}
 \quad \goodType{\Gm, A}{T}{i}}
{\goodSig{\Gm}{(\nu^+ \ \sigma \ \{f\} \ T)}{n+1}}
$$

$$ 
\Rule[name=Sig Proj]
{\goodSig{\Gm}{\sigma}{n+1}}
{\goodSig{\Gm}{p_1\nu \ \sigma}{n}
\\ \goodType{\Gm}{p_1\nu' \ \sigma}{}
\\ \goodSeal{\Gm}{p_f\nu \  \sigma}{p_1\nu \  \sigma}{p_1\nu' \sigma}
\\ \goodType{\Gm, p_1\nu' \ \sigma}{p_2\nu \ \sigma}{}
}
$$

$$ 
\Rule[name=Sig Proj Beta]
{\goodSig{\Gm}{\sigma}{n} 
\quad \goodType{\Gm}{A}{}
\quad \goodSeal{\Gm}{f}{\sigma}{A}
\quad \goodType{\Gm, A}{T}{i}}
{\goodSig{\Gm}{p_1\nu \ (\nu^+ \ \sigma \ \{f\} \ T) \equiv \sigma}{n}
\\ \goodType{\Gm}{p_1\nu' \ (\nu^+ \ \sigma \ \{f\} \ T) \equiv A}{}
\\ \goodSeal{\Gm}{p_f\nu \  (\nu^+ \ \sigma \ \{f\} \ T) \equiv f}{\sigma}{A}
\\ \goodType{\Gm, p_1\nu' \ \sigma}{p_2\nu \ (\nu^+ \ \sigma \ \{f\} \ T) \equiv T}{}
}
$$

$$
\Rule[name=Ept Lnkg]
{}
{\goodTerm{\Gm}{\mu\cdot}{\cL \nu\cdot}}
\quad
\Rule[name=Lnkg Add]
{ \goodTerm{\Gm}{o}{\cL \sigma} 
\quad \goodType{\Gm}{A}{}
\quad  \goodSeal{\Gm}{f}{\sigma}{A} 
 \quad \goodTerm{\Gm, A}{t}{T}
}
{\goodTerm{\Gm}{(\mu^+ \ o \ \{f\} \ t)}{\cL(\nu^+ \ \sigma \ \{f\} \ T)}}
$$

$$
\Rule[name=Lnkg Proj]
{\goodTerm{\Gm}{o}{\cL\sigma}}
{\goodTerm{\Gm}{p_1\mu \ o}{\cL (p_1\nu \ \sigma)}
\\ \goodTerm{\Gm, p_1\nu' \ \sigma}{p_2\mu \ o}{p_2\nu \ \sigma}
}
\quad 
\Rule[name=Lnkg Compile]
{ \goodTerm{\Gm}{o}{\cL \sigma} 
}
{
  \goodTerm{\Gm}{\cCt o}{\cC \sigma}
}
$$
$$ 
\Rule[name=Lnkg Proj Beta]
{\goodTerm{\Gm}{o}{\cL \sigma} 
\quad \goodType{\Gm}{A}{}
\quad  \goodSeal{\Gm}{f}{\sigma}{A} 
 \quad \goodTerm{\Gm, A}{t}{T}}
{\goodTerm{\Gm}{p_1\mu \ (\mu^+ \ o \ \{f\} \ t) \equiv o}{\cL \sigma}
\\ \goodTerm{\Gm, A}{p_2\mu \  (\mu^+ \ o \ \{f\} \ t) \equiv t}{T}
}
$$
$$
\Rule[name=Compile]
{}
{\goodType{\Gm}{\cC \nu\cdot \equiv \top}{} 
\\
\goodType{\Gm}{\cC (\nu^+ \ \sigma \ \{f\} \ T) \equiv 
    \Sigma (\cC \sigma) T["sf" \ f]}{}
\\\\ \goodTerm{\Gm}{ \cCt \mu\cdot \equiv ()}{\cC \nu\cdot}
\\ \goodTerm{\Gm}{\cCt \ (\mu^+ \ o \ \{f\}\ t) \equiv ((\cCt \ o), t["sf" \ f][(id, \cCt \ o)]) }{}
}
$$


\begin{figure}[H]

  \judgebox{[\goodSeal{\Gm}{s}{\sigma}{A}] 
  = [\goodTerm{\Gm, \cC\sigma}{s}{A[\pi_1]}] }
  $$
  \Rule[name=Seal Subst]
  {\goodSeal{\Delta}{s}{\sigma}{A}
    \quad {\goodSub{\Gm}{\gm}{\Delta}}}
  {\goodSeal{\Gm}{ \sub{s}{\gm}}{ \sub{\sigma}{\gm}}{ \sub{A}{\gm}}}
  =
  \frac
  {\goodTerm{\Delta, \cC\sigma}{s}{ \sub{A}{\pi_1}}
    \quad  \goodSub{\Gm}{\gm}{\Delta}  }
  {\goodTerm{\Gm,\cC\sub{\sigma}{\gm}}{ \sub{s}{\gm^\uparrow}}{\sub{\sub{A}{\pi_1}}{\gm^\uparrow}\equiv \sub{\sub{A}{\gm}}{\pi_1}}}
  $$
  $$
  \Rule[name=Seal-Id]
  {}
  {\goodSeal{\Gm}{id_s}{\sigma}{\cC \sigma}}
  = \goodTerm{\Gm, \cC\sigma}{\pi_2}{\cC\sub{\sigma}{\pi_1}}
  $$

\medskip

\end{figure}

$$
\Rule[name=Hdler]
{\goodType{\Gm}{A}{}
\quad \goodType{\Gm, A}{B}{}
\quad \goodType{\Gm}{R}{}
}
{\goodType{\Gm}{"RecSig1"~A~B~R \equiv (\TyPi {A} {(\TyPi {(\TyPi {B} {(\sub{R}{\pi_1\circ\pi_1})})} {\sub{R}{\pi_1\circ\pi_1}})} )}{}}
\quad 
\Rule[name=Hdlers]
{\goodWSig{\Gm}{\wsig}{n}
\quad \goodType{\Gm}{R}{}
}
{\goodSig{\Gm}{"RecSig"~\wsig~R}{n}}
$$
$$
\Rule[name=Hdler-Proj]
{ \goodWSig{\Gm}{\wsig}{N}
\quad \goodTerm{\Gm}{o}{\cL("RecSig"~\wsig~R)}
\quad j < N
}
{\goodTerm{\Gm}{"prjR"~j~o}{\sub{("RecSig1"~(\pi_1^j \wsig)~(\pi_2^j \wsig)~R)}{\pi_1}}}
$$
$$
\Rule[name=Rec-Constr]
{ \goodWSig{\Gm}{\wsig}{N}
\quad \goodType{\Gm}{R}{}
\quad \goodTerm{\Gm}{r}{\cL("RecSig"~\wsig~R)}
\quad \goodTerm{\Gm}{w}{\El{(\wcode{\wsig})}}
}
{\goodTerm{\Gm}{"Wrec"~r~w}{R}}
$$


\judgebox{\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}}

$$
\Rule[name=Inh-Id]
{}
{\goodInh{\Gm}{"inhid"}{\sigma}{\sigma}}
\quad
\Rule[name=Inh-Override]
{
\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}  
\quad \goodType{\Gm, A_1}{T_1}{}
\quad \goodType{\Gm, A_2}{T_2}{}
  \quad \goodTerm{\Gm, A_2}{t}{T_2}}
{\goodInh{\Gm}{"inhov" \ h \ t}{(\nu^+ \  \sigma_1 \  T_1)}{(\nu^+ \  \sigma_2\  T_2)}}
$$

$$
\Rule[name=Inh-Ext]
{\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}
  \quad \goodTerm{\Gm, A_2}{t}{T}}
{\goodInh{\Gm}{"inhext" \ h \ t}{\sigma_1}{(\nu^+ \  \sigma_2\  T)}}
\quad
\Rule[name=Inh-Inh]
{\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}
\quad \goodType{\Gm, A_1}{T}{}
\quad \goodTerm{\Gm, A_2}{\uparrow^s}{\sub{A_1}{\pi_1}}
}
{\goodInh{\Gm}{"inhinh" \ h}{(\nu^+ \  \sigma_1 \  T)}{(\nu^+ \  \sigma_2 \  T[(\pi_1, \uparrow^s)])}}
$$
$$
\Rule[name=Inh]
{\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}
\quad \goodTerm{\Gm}{l}{\cL \sigma_1}
}
{\goodTerm{\Gm}{("inh" \ h \ l)}{\cL \sigma_2}} 
\quad
\Rule[name=Inh+Inh]
{\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}
\quad \goodTerm{\Gm, A_2}{\uparrow^s}{\sub{A_1}{\pi_1}}
\\\\
\goodInh{\Gm, A_2}{i}{\tau_1[(\pi_1, \uparrow^s)]}{\tau_2}}
{\goodInh{\Gm}{"inhnest" \ h \ i}{(\nu^+ \  \sigma_1\  \cL\tau_1)}{(\nu^+ \  \sigma_2\  \cL\tau_2)}}
\quad
$$

$$
\Rule[name=Inh-Inh-beta]
{\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}
  \quad \goodTerm{\Gm}{m}{\cL \sigma_1}
  \quad \goodTerm{\Gm, A_1}{t}{T}
  \quad \goodTerm{\Gm, A_2}{\uparrow^s}{\sub{A_1}{\pi_1}}
}
{\goodTerm{\Gm}{"inh" ("inhinh" \ h) (\mu^+ \ m \  \{f_1\} \ t) \newline  \equiv \mu^+ \ ("inh" \ h \ m) \  \{f_2\} \ t[(\pi_1, \uparrow^s)]}{...}} 
$$