\judgebox{\goodCtx{\Gm}{i}}
$$ 
\Rule[name=Empty Context]{}{\goodCtx{\cdot}{0}} 
\quad
\Rule[name=Context Extension]
{\goodCtx{\Gm}{i} \quad \goodType{\Gm}{A}{j}}
{\goodCtx{\Gm, A}{i \cup j}}  
$$


\judgebox{ \goodType{\Gm}{T}{i} }
$$
\Rule[name=Type Universe]
{}
{\goodType{\Gm}{\cU}{j + 1}}
\quad 
\Rule[name=Boolean]
{}
{\goodType{\Gm}{\cB}{0}}
\quad 
\Rule[name=Bottom]
{}
{\goodType{\Gm}{\bot}{0}}
\quad 
\Rule[name=Function]
{\goodType{\Gm}{A}{j} 
  \quad \goodType{\Gm, A}{B}{k}}
{\goodType{\Gm}{\TyPi{A}{B}}{j \cup k}}
$$

$$
\quad 
\Rule[name=Func/DPair Subst]
{\goodSub{\Gm}{\gm}{\Delta}
\quad \goodType{\Delta}{A}{} 
\quad \goodType{\Delta, A}{B}{}
}
{
  \goodType{\Gm}{ \sub{(\TyPi {A} {B})}{\gm} \equiv \TyPi {\sub{A}{\gm}} {\sub{B}{\gm^\uparrow}} }{j \cup k}
  \quad 
  \goodType{\Gm}{ \sub{(\Sigma A B)}{\gm} \equiv \Sigma \sub{A}{\gm} \sub{B}{\gm^\uparrow} }{j \cup k}
}
$$

$$
\Rule[name=Type Subst]
{\goodType{\Delta}{T}{j} 
  \quad {\goodSub{\Gm}{\gm}{\Delta}}}
{\goodType{\Gm}{\sub{T}{\gm}}{j}}
\quad
\Rule[name=Base Type Subst]
{\goodSub{\Gm}{\gm}{\Delta}}
{\goodType{\Gm}{\sub{\cU}{\gm} \equiv \cU }{j + 1} \quad
  \goodType{\Gm}{\sub{\cB}{\gm} \equiv \cB}{0} \quad 
  \goodType{\Gm}{ \sub{\bot}{\gm} \equiv \bot}{0}
}
$$
\judgebox{ \goodTerm{\Gm}{t}{T} }
$$
\Rule[name=Code/Get Type]
{\goodType{\Gm}{T}{j}}
{\goodTerm{\Gm}{\codety{T}}{\cU}
}\quad
\Rule[]
{\goodTerm{\Gm}{T}{\cU}}
{\goodType{\Gm}{\El{T}}{j}}
\quad 
\Rule[name=Term Subst]
{\goodTerm{\Delta}{t}{T}
  \quad {\goodSub{\Gm}{\gm}{\Delta}}}
{\goodTerm{\Gm}{ \sub{t}{\gm}}{ \sub{T}{\gm} }}
$$
$$
\Rule[]
{\goodTerm{\Gm, A}{t}{B}}
{\goodTerm{\Gm}{\lam{t}}{\TyPi {A} {B}}}
\quad 
\Rule[]
{\goodTerm{\Gm}{t}{\TyPi {A} {B}}}
{\goodTerm{\Gm, A}{\app{t}}{B}}
\quad 
\Rule[]
{\goodTerm{\Gm}{u}{A} 
\quad \goodTerm{\Gm}{v}{B[(id, u)]}}
{\goodTerm{\Gm}{(u,v)}{\Sigma A B}}
\quad 
\Rule[name=Sigma Elim]
{\goodTerm{\Gm}{t}{\Sigma A B}}
{\goodTerm{\Gm}{\fst{t}}{A}
\\\\ \goodTerm{\Gm}{\snd{t}}{B[(id, \fst{t})]}
}
$$
$$
\Rule
{}
{\goodTerm{\Gm}{ \sub{(\lam{t})}{\gm} \equiv \lam{(\sub{t}{\gm^\uparrow})}}{\TyPi {A} {B}}
\quad \goodTerm{\Gm}{ \sub{(u,v)}{\gm} \equiv (\sub{u}{\gm},\sub{v}{\gm})}{\Sigma A B}
\quad \goodType{\Gm}{\El{(\sub{T}{\gm})} \equiv \sub{(\El{T})}{\gm}}{}
}
$$

$$
\Rule[name=Bool]
{}
{\goodTerm{\Gm}{\true, \false}{\cB}}
\quad
\Rule[]
{\goodSub{\Gm}{\gm}{\Delta}}
{\goodType{\Gm}{ \sub{(\El{T})}{\gm} \equiv \El{(\sub{T}{\gm})} }{j} \quad
 \goodTerm{\Gm}{ \sub{\true}{\gm} \equiv \true}{\cB} \quad 
 \goodTerm{\Gm}{ \sub{\false}{\gm} \equiv \false}{\cB} 
}
$$
\judgebox{\goodSub{\Gm}{\gm}{\Delta}}
$$
\Rule[name=Ept Subst]
{}{\goodSub{\Gm}{\epsilon}{\cdot}}
\quad
\Rule[]
{}{\goodSub{\Gm}{"id"}{\Gm}}
\quad
\Rule[name=Sub Comp]{
  \goodSub{\Delta}{\delta}{\Theta}
  \quad \goodSub{\Gm}{\gm}{\Delta} 
}{\goodSub{\Gm}{ \SubstComp{\delta}{\gm}}{\Theta}}
\Rule[name=Sub Extend]
{\goodSub{\Gm}{\gm}{\Delta} \quad \goodTerm{\Gm}{t}{ \sub{A}{\gm}}}
{\goodSub{\Gm}{(\gm, t)}{(\Delta, A)}}
$$

$$
\Rule[name=Proj Subst-1]
{\goodSub{\Gm}{\gm}{(\Delta, A)}}
{\goodSub{\Gm}{\pi_1 \gm}{\Delta}}
\quad
\Rule[name=Proj Subst-2]
{\goodSub{\Gm}{\gm}{(\Delta, A)}}
{\goodSub{\Gm}{\pi_2 \gm}{ \sub{A}{\pi_1 \gm}}}
\quad
\Rule[name=Proj-Ext]
{}
{\goodSub{\Gm}{(\pi_1 \gm, \pi_2 \gm) \equiv \gm}{\Delta}}
$$



\judgebox{\goodWSig{\Gm}{\wsig}{n}}
$$
\Rule[name=Emp-WSig]
{}
{\goodWSig{\Gm}{\WSigEmp}{0}}
\quad 
\Rule[name=Emp-WSig-Eta]
{\goodWSig{\Gm}{\wsig}{0}}
{\goodWSig{\Gm}{\wsig \equiv \WSigEmp}{0}}
\quad
\Rule[name=WSig-Add]
{\goodWSig{\Gm}{\wsig}{n}
  \quad \goodType{\Gm}{A}{i}
  \quad \goodType{\Gm, A}{B}{i}}
{\goodWSig{\Gm}{\WSigAdd{\wsig}{A}{B}}{n+1}}
\quad
\Rule[name=Ind-Univ]
{\goodWSig{\Gm}{\wsig}{n}}
{\goodType{\Gm}{\TyWSingle {\wsig}}{i}
\\ \goodTerm{\Gm}{\wsingle{\wsig}}{\TyWSingle{\wsig}}
}
$$



$$
\Rule[name=WSig-Proj + Eta]
{\goodWSig{\Gm}{\wsig}{n} \quad j < n}
{\goodType{\Gm}{\wsigproj{j}{1}{\wsig} }{i} \\ \goodType{\Gm, \wsigproj{j}{1}{\wsig}}{\wsigproj{j}{2}{\wsig}}{i}
}
\quad
\Rule[name=Ind-Sig Subst]
{\goodWSig{\Delta}{\wsig}{n}
  \quad {\goodSub{\Gm}{\gm}{\Delta}}}
{\goodWSig{\Gm}{ \sub{\wsig}{\gm}}{n}
  \\ \goodTerm{\Gm}{\wcode{( \sub{\wsig}{\gm})} \equiv \sub{(\wcode{ \wsig})}{\gm}}{\cU}
\\\\ \goodTerm{\Gm}{\sub{\wsingle{\wsig}}{\gm} \equiv \wsingle{\wsig}}{\TyWSingle{\wsig}} 
  }
$$

$$
\Rule[name=WSig-Proj Beta]{
  \goodSub{\Gm}{\gm}{\Theta}
}{
  \goodType{\Gm}{\wsigproj{j+1}{1}{ \WSigAdd{\wsig}{A}{B} } \equiv \wsigproj{j}{1}{\wsig} }{i} 
  \\ \goodType{\Gm, \wsigproj{j+1}{1}{\WSigAdd{\wsig}{A}{B}}}{\wsigproj{j+1}{2}{\WSigAdd{\wsig}{A}{B}} \equiv \wsigproj{j}{2}{\wsig}}{i}
  \\\\ 
  \goodType{\Gm}{\wsigproj{0}{1}{ \WSigAdd{\wsig}{A}{B} } \equiv A }{i} 
  \\ \goodType{\Gm, \wsigproj{0}{1}{ \WSigAdd{\wsig}{A}{B} }}{\wsigproj{j}{2}{ \WSigAdd{\wsig}{A}{B} } \equiv B}{i}
}
$$

$$
\Rule[name=WSig Sub]
{\goodWSig{\Gm}{\wsig}{n+1}}
{\goodWSig{\Gm}{\WSigSub{\wsig}}{n}}
\quad
\Rule[name=WSig Add/Proj Subst]
{\goodSub{\Gm}{\gm}{\Theta}}
{\goodWSig{\Gm}{\sub{\WSigEmp}{\gm} \equiv \WSigEmp}{0}
\\ \goodWSig{\Gm}{\sub{\WSigAdd{\wsig}{A}{B}}{\gm} \equiv \WSigAdd{\sub{\wsig}{\gm}}{\sub{A}{\gm}}{\sub{B}{\gm^\uparrow}} }{n+1}
\\\\ \goodType{\Gm}{\sub{\wsigproj{j}{1}{\wsig}}{\gm} \equiv \wsigproj{j}{1}{\sub{\wsig}{\gm}}}{i} 
\\ \goodType{\Gm, \wsigproj{j}{1}{\sub{\wsig}{\gm}}}{\sub{\wsigproj{j}{2}{\wsig} }{\gm^\uparrow} \equiv \wsigproj{j}{2}{\sub{\wsig}{\gm}}}{i}
}
\quad 
$$



$$
\Rule[name=Ind-Type/Universe]
{\goodWSig{\Gm}{\wsig}{n}}
{\goodTerm{\Gm}{\wcode{\wsig}}{\cU}
}
\quad
\Rule[name=Ind-Term]
{{\goodWSig{\Gm}{\wsig}{n}}
  \quad \goodTerm{\Gm}{a}{\wsigproj{j}{1}{\wsig}}
  \quad \goodTerm{\Gm, \sub{\wsigproj{j}{2}{\wsig}}{(id, a)}}{b}{\El{(\wcode{\wsig})}}}
{\goodTerm{\Gm}{\wsup{T}{a}{b}}{\El{(\wcode{\wsig})}} }
$$

$$
\Rule[name=WSig Sub Beta]{
  \goodWSig{\Gm}{\wsig}{n}
  \quad \goodType{\Gm}{A}{i}
  \quad \goodType{\Gm, A}{B}{i}
}{
  \goodWSig{\Gm}{\sub{\WSigSub{\WSigAdd{\wsig}{A}{B}}}{\gm} \equiv \wsig}{n}
}
$$

$$
\Rule[name=WSig Sub Subst]{
  \goodSub{\Gm}{\gm}{\Theta}
}{
  \goodWSig{\Gm}{\sub{\WSigSub{\wsig}}{\gm} \equiv \WSigSub{\sub{\wsig}{\gm}}}{n}
}
\quad
\Rule[name=Ind-Term Subst]
{\goodSub{\Gm}{\gm}{\Theta}}
{\goodTerm{\Gm}{\sub{\wsup{T}{a}{b}}{\gm} \equiv \wsup{\sub{T}{\gm}}{\sub{a}{\gm}}{\sub{b}{\gm^\uparrow}} }{\El{(\wcode{\sub{\wsig}{\gm}})}} }
$$


\judgebox{\goodSig{\Gm}{\lsig}{n} }
$$
\Rule[name=Lnkg Type+Compile]
{\goodSig{\Gm}{\lsig}{n}}
{\goodType{\Gm}{\TyLkg{\lsig}}{i}
\\ \goodType{\Gm}{\TyTkg{\lsig}}{}}
\quad
\Rule[name=Sig/Lnkg/Compile Subst]
{\goodSig{\Delta}{\lsig}{n}
  \\ {\goodSub{\Gm}{\gm}{\Delta}}}
{\goodSig{\Gm}{ \sub {\lsig}{\gm}}{n}
  \\ \goodType{\Gm}{\TyLkg{ \sub{\lsig}{\gm}} \equiv \sub{(\TyLkg{\lsig})}{\gm}}{i}
  \\ \goodType{\Gm}{\TyTkg{ \sub{\lsig}{\gm}} \equiv \sub{(\TyTkg{\lsig})}{\gm}}{i}
  }
$$

$$
\Rule[name=Ept Sig]
{}
{\goodSig{\Gm}{\LSigEmp}{0}}
\quad 
\Rule[name=Ept Sig Eta]
{\goodSig{\Gm}{\lsig}{0}}
{\goodSig{\Gm}{\lsig \equiv \LSigEmp}{0}}
\quad
\Rule[name=Sig Add]
{\goodSig{\Gm}{\lsig}{n} 
 \quad \goodType{\Gm}{A}{}
 \quad \goodSeal{\Gm}{\seal}{\lsig}{A}
 \quad \goodType{\Gm, A}{T}{i}}
{\goodSig{\Gm}{(\LSigAdd {\lsig}{\seal}{T})}{n+1}}
$$

$$ 
\Rule[name=Sig Proj and Eta]
{\goodSig{\Theta}{\lsig}{n+1} 
\\ \goodSub{\Gm}{\gm}{\Theta}
}
{\goodSig{\Gm}{\lsigproj{1} {\lsig}}{n}
\\ \goodType{\Gm}{\lsigprojT {\lsig}}{}
\\ \goodSeal{\Gm}{\lsigproj{s}{\lsig}}{\lsigproj{1} {\lsig}}{\lsigprojT {\lsig}}
\\ \goodType{\Gm, \lsigprojT {\lsig}}{\lsigproj{2}{\lsig}}{} 
\\ 
\goodSig{\Gm}{\LSigAdd{\lsigproj{1} {\lsig}}{\lsigproj{s}{\lsig}}{\lsigproj{2}{\lsig}} \equiv \lsig }{n+1}
}
$$

$$ 
\Rule[name=Sig Proj Beta]
{\goodSig{\Gm}{\lsig}{n} 
\quad \goodType{\Gm}{A}{}
\quad \goodSeal{\Gm}{\seal}{\lsig}{A}
\quad \goodType{\Gm, A}{T}{i}}
{\goodSig{\Gm}{\lsigproj{1} {(\LSigAdd  {\lsig}  {\seal}  {T})} \equiv \lsig}{n}
\\ \goodType{\Gm}{\lsigprojT {(\LSigAdd  {\lsig} {\seal} {T})} \equiv A}{}
\\ \goodSeal{\Gm}{\lsigproj{s}{(\LSigAdd{\lsig} {\seal} {T})} \equiv \seal}{\lsig}{A}
\\ \goodType{\Gm, A}{\lsigproj{2}{(\LSigAdd {\lsig} {\seal}  {T})} \equiv T}{}
}
$$

$$ 
\Rule[name=Sig Add/Proj Subst]
{\goodSig{\Gm}{\gm}{\Theta}}
{
\goodSig{\Gm}{\sub{\LSigEmp}{\gm} \equiv \LSigEmp}{n}
\\ \goodSig{\Gm}{\sub{(\LSigAdd {\lsig}{\seal}{T})}{\gm} \equiv 
  \LSigAdd {\sub{\lsig}{\gm}}{\sub{\seal}{\gm^\uparrow}}{\sub{T}{\gm^\uparrow}}
}{n+1}
\\ \goodSig{\Gm}{ \sub{\lsigproj{1}{\lsig}}{\gm} \equiv \lsigproj{1}{\sub{\lsig}{\gm}} }{n}
\\ \goodType{\Gm}{\sub{\lsigprojT {\lsig}}{\gm} \equiv \lsigprojT {\sub{\lsig}{\gm}}}{}
\\ \goodSeal{\Gm}{\sub{\lsigproj{s}{\lsig}}{\gm} \equiv {\lsigproj{s}{\sub{\lsig}{\gm}}} }{\lsig}{A}
\\ \goodType{\Gm, \lsigprojT {\sub{\lsig}{\gm}}}{ \sub{\lsigproj{2}{\lsig}}{\gm^\uparrow} \equiv  \lsigproj{2}{ \sub{\lsig}{\gm} }  }{}
}
$$


$$
\Rule[name=Ept Lnkg]
{}
{\goodTerm{\Gm}{\LkgEmp}{\TyLkg {\LSigEmp}}  
}
\quad 
\Rule[name=Ept Lnkg Eta]
{\goodTerm{\Gm}{o}{\TyLkg {\LSigEmp}}}
{\goodTerm{\Gm}{o \equiv \LkgEmp}{\TyLkg {\LSigEmp}}}
\quad 
\Rule[name=Lnkg Compile]
{ \goodTerm{\Gm}{o}{\TyLkg {\lsig}} 
}
{
  \goodTerm{\Gm}{\Tkg {o}}{\TyTkg{\lsig}}
}
\quad
\Rule[name=Lnkg Compile Subst]
{ \goodSub{\Gm}{\gm}{\Theta}
}
{
  \goodTerm{\Gm}{\sub{\Tkg {o}}{\gm} \equiv \Tkg {\sub{o}{\gm}}}{\TyTkg{\lsig}}
}
$$

$$
\Rule[name=Lnkg Add]
{ \goodTerm{\Gm}{o}{\TyLkg {\lsig}} 
\\ \goodType{\Gm}{A}{}
\\  \goodSeal{\Gm}{\seal}{\lsig}{A} 
\\  \goodTerm{\Gm, A}{t}{T}
}
{\goodTerm{\Gm}{(\LkgAdd {o} {t})}{\TyLkg{\LSigAdd {\lsig} {\seal} {T}}}
}
\quad
\Rule[name=Lnkg Add Eta]
{\goodTerm{\Gm}{o}{\TyLkg \lsig}}
{\goodTerm{\Gm}{\LkgAdd{\lkgproj{1}{o}}{\lkgproj{2}{o}}{\TyLkg{\lsig}} \equiv o }{\TyLkg{\lsig}}}
$$


$$
\Rule[name=Lnkg Proj]
{\goodTerm{\Gm}{o}{\TyLkg{\lsig}}}
{\goodTerm{\Gm}{\lkgproj{1} {o}}{\TyLkg {(\lsigproj{1} {\lsig})}}
\\ \goodTerm{\Gm, \lsigprojT {\lsig}}{\lkgproj{2}{o}}{\lsigproj{2}{\lsig}}
}
$$

$$ 
\Rule[name=Lnkg Proj Beta]
{\goodTerm{\Gm}{o}{\TyLkg {\lsig}} 
\quad \goodType{\Gm}{A}{}
\quad  \goodSeal{\Gm}{f}{\lsig}{A} 
 \quad \goodTerm{\Gm, A}{t}{T}}
{\goodTerm{\Gm}{\lkgproj{1} {(\LkgAdd {o} {t})} \equiv o}{\TyLkg \lsig}
\\ \goodTerm{\Gm, A}{\lkgproj{2}{(\LkgAdd {o}{t})} \equiv t}{T}
}
$$
$$
\Rule[name=Lnkg Add/Proj Subst]
{\goodSub{\Gm}{\gm}{\Theta}}
{
\goodTerm{\Gm}{\sub{\LkgEmp}{\gm} \equiv \LkgEmp}{\TyLkg {\LSigEmp}}
\\ \goodTerm{\Gm}{\sub{(\LkgAdd {o} {t}) }{\gm} \equiv (\LkgAdd {\sub{o}{\gm}} {\sub{t}{\gm^\uparrow}})}{\sub{\TyLkg{\LSigAdd {\lsig} {\seal} {T}}}{\gm}}
\\\\ \goodTerm{\Gm}{ \sub{\lkgproj{1} {o}}{\gm} \equiv \lkgproj{1} {\sub{o}{\gm}} }{\sub{\TyLkg (\lsigproj{1} {\lsig})}{\gm}}
\\
\goodTerm{\Gm, \lsigprojT {\sub{\lsig}{\gm}}}{\sub{\lkgproj{2}{o}}{\gm^\uparrow} \equiv \lkgproj{2}{\sub{o}{\gm}}}{\lsigproj{2}{\lsig}}}
$$


$$
\Rule[name=Compile]
{}
{\goodType{\Gm}{\TyTkg{\LSigEmp} \equiv \top}{} 
\\
\goodType{\Gm}{\TyTkg {\LSigAdd  {\lsig} {f} {T}} \equiv 
    \Sigma (\TyTkg {\lsig}) T["sf" \ f]}{}
\\\\ \goodTerm{\Gm}{ \Tkg {\LkgEmp} \equiv ()}{\TyTkg{\LSigEmp}}
\\ \goodTerm{\Gm}{\Tkg {(\LkgAdd {o} {t})} \equiv ((\Tkg {o}), t["sf" \ f][(id, \Tkg {o})]) }{}
}
$$


\begin{figure}[H]

  \judgebox{[\goodSeal{\Gm}{s}{\lsig}{A}] 
  = [\goodTerm{\Gm, \TyTkg{\lsig}}{s}{A[\pi_1]}] }
  $$
  \Rule[name=Seal Subst]
  {\goodSeal{\Delta}{s}{\lsig}{A}
    \quad {\goodSub{\Gm}{\gm}{\Delta}}}
  {\goodSeal{\Gm}{ \sub{s}{\gm}}{ \sub{\lsig}{\gm}}{ \sub{A}{\gm}}}
  =
  \frac
  {\goodTerm{\Delta, \TyTkg{\lsig}}{s}{ \sub{A}{\pi_1}}
    \quad  \goodSub{\Gm}{\gm}{\Delta}  }
  {\goodTerm{\Gm,\TyTkg{\sub{\lsig}{\gm}}}{ \sub{s}{\gm^\uparrow}}{\sub{\sub{A}{\pi_1}}{\gm^\uparrow}\equiv \sub{\sub{A}{\gm}}{\pi_1}}}
  $$
  $$
  \Rule[name=Seal-Id]
  {}
  {\goodSeal{\Gm}{id_s}{\lsig}{\TyTkg {\lsig}}}
  = \goodTerm{\Gm, \TyTkg{\lsig}}{\pi_2}{\TyTkg{\sub{\lsig}{\pi_1}}}
  $$

\medskip

\end{figure}

$$
\Rule[name=Hdler]
{\goodType{\Gm}{A}{}
\quad \goodType{\Gm, A}{B}{}
\quad \goodType{\Gm}{R}{}
}
{\goodType{\Gm}{\CaseSig{A}{B}{R} \equiv (\TyPi {A} {(\TyPi {(\TyPi {B} {(\sub{R}{ \SubstComp {\pi_1}{\pi_1}})})} {\sub{R}{\SubstComp{\pi_1}{\pi_1}}})} )}{}}
$$

$$
\Rule[name=Hdlers-DefN]
{\goodWSig{\Gm}{\wsig}{n+1}
}
{\goodSig{\Gm}{\RecSig{\wsig}{R} \equiv 
        \LSigAdd{\RecSig{\WSigSub{\wsig}}{R}}
        {\pi_2}
        {\CaseSig{\wsigproj{0}{1}{\wsig}}{\wsigproj{0}{2}{\wsig}}{R}} }{n+1}}
$$

$$
\Rule[name=Hdlers-Def0]
{\goodWSig{\Gm}{\wsig}{0}
}
{\goodSig{\Gm}{\RecSig{\wsig}{R} \equiv \LSigEmp}{0}}
\quad
\Rule[name=Hdler-Proj]
{ \goodWSig{\Gm}{\wsig}{N}
\quad \goodTerm{\Gm}{o}{\TyLkg{(\RecSig{\wsig}{R})}}
\quad j < N
}
{\goodTerm{\Gm}{\Recproj{j}{o}}{\sub{(\CaseSig{(\pi_1^j \wsig)}{(\pi_2^j \wsig)}{R})}{\pi_1}}}
$$
$$
\Rule[name=Rec-Constr]
{ \goodWSig{\Gm}{\wsig}{N}
\quad \goodType{\Gm}{R}{}
\quad \goodTerm{\Gm}{r}{\TyLkg{(\RecSig{\wsig}{R})}}
\quad \goodTerm{\Gm}{w}{\El{(\wcode{\wsig})}}
}
{\goodTerm{\Gm}{\Wrec{w}{r}}{R}}
$$

$$
\Rule[name=Rec Proj]{
  \goodWSig{\Gm}{\wsig}{N}
  \\ j < N
  \\ \goodTerm{\Gm}{o}{\TyLkg{\RecSig{\wsig}{R}}}
}{
  \goodTerm{\Gm}{\Recproj{j}{o}}{
    \CaseSig{\wsigproj{j}{1}{\wsig}}{\wsigproj{j}{2}{\wsig}}{R}}
}
$$

$$
\Rule[name=Rec Proj DefN]{}{
  \goodTerm{\Gm}{\Recproj{n+1}{o} \equiv \Recproj{n}{ \lkgproj{1}{o}}}{}
}
\quad 
\Rule[name=Rec Proj Def0]{}{
  \goodTerm{\Gm}{\Recproj{0}{o} \equiv \sub{\lkgproj{2}{o}}{("id", \Tkg{\lkgproj{1}{o}})}}{}
}
$$

$$
\Rule[name=Rec-Beta]
{\goodTerm{\Gamma}{h}{\cL(\RecSig{\tau}{R})} 
\\ \goodTerm{\Gamma}{T}{\TyWSingle{\tau}}}
{\goodTerm{\Gamma}{\Wrec{h}{(\wsup{\wsig}{a}{b})} \equiv 
(\app{((\app{(\Recproj{j}{h})} )[("id", a)])} )[("id", \lam{(\Wrec{h[\pi_1]}{b})})]
}{R}}$$


\judgebox{\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}}

$$
\Rule[name=Inh-Id]
{}
{\goodInh{\Gm}{\InhId}{\lsig}{\lsig}}
\quad
\Rule[name=Inh-Override]
{
\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}  
\quad \goodType{\Gm, A_1}{T_1}{}
\quad \goodType{\Gm, A_2}{T_2}{}
  \quad \goodTerm{\Gm, A_2}{t}{T_2}}
{\goodInh{\Gm}{\InhOv{h}{t}}{(\LSigAdd  {\sigma_1 } {\seal_1} {T_1})}{(\LSigAdd   {\sigma_2} {\seal_2} {T_2})}}
$$

$$
\Rule[name=Inh-Ext]
{\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}
  \quad \goodTerm{\Gm, A_2}{t}{T}}
{\goodInh{\Gm}{\InhExt {h} {t}}{\sigma_1}{(\LSigAdd {\sigma_2} {\seal_2} { T})}}
\quad
\Rule[name=Inh-Inh]
{\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}
\quad \goodType{\Gm, A_1}{T}{}
\quad \goodTerm{\Gm, A_2}{\uparrow^s}{\sub{A_1}{\pi_1}}
}
{\goodInh{\Gm}{\InhInh{h}}{(\LSigAdd {\sigma_1} {\seal_1}  {T})}{(\LSigAdd   {\sigma_2} {\seal_2} {T[(\pi_1, \uparrow^s)]})}}
$$
$$
\Rule[name=Inh]
{\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}
\quad \goodTerm{\Gm}{l}{\TyLkg{\sigma_1}}
}
{\goodTerm{\Gm}{(\inh {h} {l})}{\TyLkg{\sigma_2}}} 
\quad
\Rule[name=Inh+Inh]
{\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}
\quad \goodTerm{\Gm, A_2}{\uparrow^s}{\sub{A_1}{\pi_1}}
\\\\
\goodInh{\Gm, A_2}{i}{\tau_1[(\pi_1, \uparrow^s)]}{\tau_2}}
{\goodInh{\Gm}{\InhNest{h}{i}}{(\LSigAdd {\sigma_1} {\seal_1}  {\TyLkg\tau_1})}{(\LSigAdd   {\sigma_2} {\seal_2} {\TyLkg{\tau_2})}}}
\quad
$$

$$
\Rule[name=Inh-Inh-beta]
{\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}
  \quad \goodTerm{\Gm}{m}{\TyLkg {\sigma_1}}
  \quad \goodTerm{\Gm, A_1}{t}{T}
  \quad \goodTerm{\Gm, A_2}{\uparrow^s}{\sub{A_1}{\pi_1}}
}
{\goodTerm{\Gm}{\inh {(\InhInh{h})} {(\LkgAdd{m}{t})} \newline  \equiv \LkgAdd{(\inh {h} {m})}  {t[(\pi_1, \uparrow^s)]}}{...}} 
$$