Note that, in the main text we use $\SubstWeak{n}$ and $\var{n}$ to manipulate variables and context for readability. In our appendices, we use $\pi_1 \gm, \pi_2 \gm$ (for arbitrary substitution $\gm$) instead. These two representations are equivalent as $\SubstWeak{n}$ is just a consecutive application of $\pi_1$, $\var{n}$ is the consecutive application of $\pi_1$ follows by $\pi_2$.

What's more, we use $\pi_1$ and $\pi_2$ (without argument) to represent $\pi_1~"id"$ and $\pi_2~"id"$.


\begin{mathparpagebreakable}
\judgebox{\goodCtx{\Gm}{i}}
\\ 
\Rule[name=ctx/ept]{ "" }{\goodCtx{\cdot}{0}} 
\Rule[name=ctx/ext]
{\goodCtx{\Gm}{i} \\ \goodType{\Gm}{A}{j}}
{\goodCtx{\Gm, A}{i \cup j}}  
\\
\end{mathparpagebreakable}
\begin{mathparpagebreakable}
\judgebox{ \goodType{\Gm}{T}{i} }
\\
\Rule[name=ty/universe]
{ "" }
{\goodType{\Gm}{\cU}{j + 1}}

\Rule[name=ty/bool]
{ "" }
{\goodType{\Gm}{\cB}{0}}

\Rule[name=ty/bot]
{ "" }
{\goodType{\Gm}{\bot}{0}}

\Rule[name=ty/top]
{ "" }
{\goodType{\Gm}{\top}{0}}

\Rule[name=ty/function]
{\goodType{\Gm}{A}{j} 
  \\ \goodType{\Gm, A}{B}{k}}
{\goodType{\Gm}{\TyPi{A}{B}}{j \cup k}}

\Rule[name=ty/pair]
{\goodType{\Gm}{A}{j} 
  \\ \goodType{\Gm, A}{B}{k}}
{\goodType{\Gm}{\TySigma{A}{B}}{j \cup k}}

\Rule[name=ty/idty]
{\goodType{\Gm}{A}{j} 
  \\ \goodTerm{\Gm}{x}{A}
  \\ \goodTerm{\Gm}{y}{A}}
{\goodType{\Gm}{\TyId{x}{y}}{j \cup k}}

\Rule[name=ty/singleton]
{\goodType{\Gm}{A}{j}
 \\ \goodTerm{\Gm}{a}{A}}
{\goodType{\Gm}{\TyS{a}}{j \cup k}}

\Rule[name=type/subst]
{\goodType{\Delta}{T}{j} 
  \\ {\goodSub{\Gm}{\gm}{\Delta}}}
{\goodType{\Gm}{\sub{T}{\gm}}{j}}

\Rule[name=tyeq/subst/id]
{""}
{\goodType{\Gm}{\sub{A}{"id"} \equiv A}{}}

\Rule[name=tyeq/subst/comp]
{""}
{\goodType{\Gm}{\sub{A}{\gm_1 \circ \gm_2} \equiv \sub{\sub{A}{\gm_1}}{\gm_2}}{}}

\Rule[name=tyeq/subst]
{\goodSub{\Gm}{\gm}{\Delta}
}
{
  \goodType{\Gm}{\sub{\cU}{\gm} \equiv \cU }{j + 1} \\
  \goodType{\Gm}{\sub{\cB}{\gm} \equiv \cB}{0} \\ 
  \goodType{\Gm}{ \sub{\bot}{\gm} \equiv \bot}{0} \\
  \goodType{\Gm}{ \sub{(\TyPi {A} {B})}{\gm} \equiv \TyPi {\sub{A}{\gm}} {\sub{B}{\gm^\uparrow}} }{j \cup k}
  \\ 
  \goodType{\Gm}{ \sub{(\Sigma A B)}{\gm} \equiv \Sigma \sub{A}{\gm} \sub{B}{\gm^\uparrow} }{j \cup k}
  \\ 
  \goodType{\Gm}{ \sub{(\TyId{a}{b})}{\gm} \equiv \TyId{\sub{a}{\gm}}{\sub{b}{\gm}} }{j \cup k}
  \\   \goodType{\Gm}{ \sub{\TyS{a}}{\gm} \equiv \TyS{\sub{a}{\gm}} } {j \cup k}
}



\end{mathparpagebreakable}
\begin{mathparpagebreakable}
\judgebox{ \goodTerm{\Gm}{t}{T} }
\\
\Rule[name=tm/code]
{\goodType{\Gm}{T}{j}}
{\goodTerm{\Gm}{\codety{T}}{\cU}
}

\Rule[name=ty/el]
{\goodTerm{\Gm}{T}{\cU}}
{\goodType{\Gm}{\El{T}}{j}}

\Rule[name=tmeq/U/beta]
{""}
{\goodType{\Gm}{\El{\codety{T}} \equiv T}{j}}

\Rule[name=tmeq/U/eta]
{""}
{\goodTerm{\Gm}{\codety{\El{T}} \equiv T}{\cU}}

\Rule[name=tm/top]
{""}
{\goodTerm{\Gm}{\unit}{\top}}

\Rule[name=tm/top/eta]
{\goodTerm{\Gm}{t}{\top}}
{\goodTerm{\Gm}{t \equiv \unit}{\top}}


\Rule[name=tm/subst]
{\goodTerm{\Delta}{t}{T}
  \\ {\goodSub{\Gm}{\gm}{\Delta}}}
{\goodTerm{\Gm}{ \sub{t}{\gm}}{ \sub{T}{\gm} }}

\Rule[name=tmeq/subst/id]
{""}
{\goodTerm{\Gm}{ \sub{t}{id} \equiv t}{ T }}

\Rule[name=tm/lam]
{\goodTerm{\Gm, A}{t}{B}}
{\goodTerm{\Gm}{\lam{t}}{\TyPi {A} {B}}}

\Rule[name=tm/app]
{\goodTerm{\Gm}{t}{\TyPi {A} {B}}}
{\goodTerm{\Gm, A}{\app{t}}{B}}

\Rule[name=tmeq/lam/beta]
{""}
{\goodTerm{\Gm, A}{\app{\lam{t}} \equiv t }{B}}

\Rule[name=tmeq/lam/eta]
{""}
{\goodTerm{\Gm}{\lam{\app{t}} \equiv t }{\TyPi{A}{B}}}

\Rule[name=tm/pair]
{\goodTerm{\Gm}{u}{A} 
\\ \goodTerm{\Gm}{v}{B[(id, u)]}}
{\goodTerm{\Gm}{(u,v)}{\Sigma A B}}

\Rule[name=tm/pair/proj]
{\goodTerm{\Gm}{t}{\Sigma A B}}
{\goodTerm{\Gm}{\fst{t}}{A}
\\ \goodTerm{\Gm}{\snd{t}}{B[(id, \fst{t})]}
}

\Rule[name=tmeq/pair/proj/beta]
{}
{\goodTerm{\Gm}{\fst{\pair{u}{v}} \equiv u}{A}
\\ \goodTerm{\Gm}{\snd{\pair{u} {v}} \equiv v}{B[(id, u)]}
}

\Rule[name=tmeq/pair/proj/eta]
{}
{\goodTerm{\Gm}{\pair{\fst{t}}{\snd{t}} \equiv t}{\TySigma{A}{B}}
}


\Rule[name=tm/bool]
{""}
{\goodTerm{\Gm}{\true, \false}{\cB}}

\Rule[name=tm/ifb]
{\goodTerm{\Gm}{c}{\cB} 
\\ \goodTerm{\Gm}{a}{T}
\\ \goodTerm{\Gm}{b}{T}}
{\goodTerm{\Gm}{\ifb{c}{a}{b}}{T}}

\Rule[name=tm/idty]
{\goodTerm{\Gm}{a}{A}}
{\goodTerm{\Gm}{\eqrefl{a}}{\TyId{a}{a}}}

\Rule[name=tm/J/BasePathInduction]
{\goodTerm{\Gm}{u}{A} 
 \\ \goodType{\Gm, A, \TyId{\sub{u}{\pi_1}}{\pi_2}}{C}{}
  \\  \goodTerm{\Gm}{w}{\sub{C}{\SubstExt{\SubstExt{id}{u}}{\eqrefl{u}}}} 
  \\ \goodTerm{\Gm}{v}{A} 
  \\ \goodTerm{\Gm}{t}{\TyId{u}{v}}
  }
{\goodTerm{\Gm}{\Jeq{w}{t}}{\sub{C}{\SubstExt{\SubstExt{id}{v}}{\eqrefl{t}}}}}

\Rule[name=tmeq/ifb/beta]
{}
{\goodTerm{\Gm}{\ifb{\true}{a}{b} \equiv a }{T} 
\\ \goodTerm{\Gm}{\ifb{\false}{a}{b} \equiv b }{T}}

\Rule[name=tmeq/J/beta]
{}
{\goodTerm{\Gm}{\Jeq{w}{\eqrefl{u}} \equiv w }{\sub{C}{\SubstExt{\SubstExt{id}{u}}{\eqrefl{u}}}}}

\Rule[name=tm/singleton]
{\goodTerm{\Gm}{a}{A}}
{\goodTerm{\Gm}{a}{\TyS{a}}}

\Rule[name=tmeq/singleton/eta]
{\goodType{\Gm}{a}{A}  
\\ \goodTerm{\Gm}{x}{\TyS{a}}}
{\goodTerm{\Gm}{x \equiv a}{A}}

\Rule[name=tm/subst]
{}
{\goodTerm{\Gm}{ \sub{(\lam{t})}{\gm} \equiv \lam{(\sub{t}{\gm^\uparrow})}}{\TyPi {A} {B}}
\\ \goodTerm{\Gm}{ \sub{(u,v)}{\gm} \equiv (\sub{u}{\gm},\sub{v}{\gm})}{\Sigma A B}
\\ \goodType{\Gm}{\El{(\sub{T}{\gm})} \equiv \sub{(\El{T})}{\gm}}{}
\\ \goodTerm{\Gm}{ \sub{\true}{\gm} \equiv \true}{\cB} 
\\  \goodTerm{\Gm}{ \sub{\false}{\gm} \equiv \false}{\cB} 
\\ \goodTerm{\Gm}{\sub{\ifb{c}{a}{b}}{\gm} \equiv \ifb{\sub{c}{\gm}}{\sub{a}{\gm}}{\sub{b}{\gm}}}{T}
\\ \goodTerm{\Gm}{\sub{\Jeq{w}{t}}{\gm} \equiv \Jeq{\sub{w}{\gm}}{\sub{t}{\gm}}}{..}
}

\end{mathparpagebreakable}
\begin{mathparpagebreakable}
\judgebox{\goodSub{\Gm}{\gm}{\Delta}}
\\
\Rule[name=subst/ept]
{""}{\goodSub{\Gm}{\epsilon}{\cdot}}
\Rule[name=substeq/ept/eta]
{ \goodSub{\Gm}{\gm}{\cdot} }{\goodSub{\Gm}{ \gm \equiv \epsilon}{\cdot}}

\Rule[name=subst/id]
{""}{\goodSub{\Gm}{"id"}{\Gm}}

\Rule[name=subst/comp]{
  \goodSub{\Delta}{\delta}{\Theta}
  \\ \goodSub{\Gm}{\gm}{\Delta} 
}{\goodSub{\Gm}{ \SubstComp{\delta}{\gm}}{\Theta}}

\Rule[name=subst/ext]
{\goodSub{\Gm}{\gm}{\Delta} \\ \goodTerm{\Gm}{t}{ \sub{A}{\gm}}}
{\goodSub{\Gm}{\SubstExt{\gm}{t}}{(\Delta, A)}}

\Rule[name=subst/proj-1]
{\goodSub{\Gm}{\gm}{(\Delta, A)}}
{\goodSub{\Gm}{\pi_1 \gm}{\Delta}}

\Rule[name=subst/proj-2]
{\goodSub{\Gm}{\gm}{(\Delta, A)}}
{\goodSub{\Gm}{\pi_2 \gm}{ \sub{A}{\pi_1 \gm}}}

\Rule[name=substeq/eta]
{""}
{\goodSub{\Gm}{(\pi_1 \gm, \pi_2 \gm) \equiv \gm}{\Delta}}

\Rule[name=substeq/comp/assoc]
{}
{\goodSub{\Gm}{ 
  \SubstComp{\gm_1}{\SubstComp{\gm_2}{\gm_3}} 
  \equiv \SubstComp{\SubstComp{\gm_1}{\gm_2}}{\gm_3} 
  }
  {\Theta}}

\Rule[name=substeq/comp/id]
{}
{\goodSub{\Gm}{ \SubstComp{id}{\gm} \equiv \SubstComp{\gm}{id} \equiv \gm}{\Theta}}

\end{mathparpagebreakable}
\begin{mathparpagebreakable}
\judgebox{\goodWSig{\Gm}{\wsig}{n}}
\\
\Rule[name=wsig/ept]
{""}
{\goodWSig{\Gm}{\WSigEmp}{0}}
 
\Rule[name=wsigeq/ept/eta]
{\goodWSig{\Gm}{\wsig}{0}}
{\goodWSig{\Gm}{\wsig \equiv \WSigEmp}{0}}

\Rule[name=wsig/add]
{\goodWSig{\Gm}{\wsig}{n}
  \\ \goodType{\Gm}{A}{i}
  \\ \goodType{\Gm, A}{B}{i}}
{\goodWSig{\Gm}{\WSigAdd{\wsig}{A}{B}}{n+1}}

\Rule[name=wsig/universe]
{\goodWSig{\Gm}{\wsig}{n}}
{\goodType{\Gm}{\TyWSingle {\wsig}}{i}
\\ \goodTerm{\Gm}{\wsingle{\wsig}}{\TyWSingle{\wsig}}
}

\Rule[name=wsigeq/proj/eta]
{\goodWSig{\Gm}{\wsig}{n} \\ j < n}
{\goodType{\Gm}{\wsigproj{j}{1}{\wsig} }{i} \\ \goodType{\Gm, \wsigproj{j}{1}{\wsig}}{\wsigproj{j}{2}{\wsig}}{i}
}

\Rule[name=wsigeq/subst]
{\goodWSig{\Delta}{\wsig}{n}
  \\ {\goodSub{\Gm}{\gm}{\Delta}}}
{\goodWSig{\Gm}{ \sub{\wsig}{\gm}}{n}
  \\ \goodTerm{\Gm}{\wcode{( \sub{\wsig}{\gm})} \equiv \sub{(\wcode{ \wsig})}{\gm}}{\cU}
\\\\ \goodTerm{\Gm}{\sub{\wsingle{\wsig}}{\gm} \equiv \wsingle{\wsig}}{\TyWSingle{\wsig}} 
  }

\Rule[name=ty/wsig/proj]{
  \goodSub{\Gm}{\gm}{\Theta}
}{
  \goodType{\Gm}{\wsigproj{j+1}{1}{ \WSigAdd{\wsig}{A}{B} } \equiv \wsigproj{j}{1}{\wsig} }{i} 
  \\ \goodType{\Gm, \wsigproj{j+1}{1}{\WSigAdd{\wsig}{A}{B}}}{\wsigproj{j+1}{2}{\WSigAdd{\wsig}{A}{B}} \equiv \wsigproj{j}{2}{\wsig}}{i}
  \\\\ 
  \goodType{\Gm}{\wsigproj{0}{1}{ \WSigAdd{\wsig}{A}{B} } \equiv A }{i} 
  \\ \goodType{\Gm, \wsigproj{0}{1}{ \WSigAdd{\wsig}{A}{B} }}{\wsigproj{j}{2}{ \WSigAdd{\wsig}{A}{B} } \equiv B}{i}
}

\Rule[name=wsig/sub]
{\goodWSig{\Gm}{\wsig}{n+1}}
{\goodWSig{\Gm}{\WSigSub{\wsig}}{n}}

\Rule[name=wsigeq/add/subst]
{\goodSub{\Gm}{\gm}{\Theta}}
{\goodWSig{\Gm}{\sub{\WSigEmp}{\gm} \equiv \WSigEmp}{0}
\\ \goodWSig{\Gm}{\sub{\WSigAdd{\wsig}{A}{B}}{\gm} \equiv \WSigAdd{\sub{\wsig}{\gm}}{\sub{A}{\gm}}{\sub{B}{\gm^\uparrow}} }{n+1}
\\\\ \goodType{\Gm}{\sub{\wsigproj{j}{1}{\wsig}}{\gm} \equiv \wsigproj{j}{1}{\sub{\wsig}{\gm}}}{i} 
\\ \goodType{\Gm, \wsigproj{j}{1}{\sub{\wsig}{\gm}}}{\sub{\wsigproj{j}{2}{\wsig} }{\gm^\uparrow} \equiv \wsigproj{j}{2}{\sub{\wsig}{\gm}}}{i}
}
 
\Rule[name=tm/wcode]
{\goodWSig{\Gm}{\wsig}{n}}
{\goodTerm{\Gm}{\wcode{\wsig}}{\cU}
}

\Rule[name=ind/cstr]
{{\goodWSig{\Gm}{\wsig}{n}}
  \\ \goodTerm{\Gm}{a}{\wsigproj{j}{1}{\wsig}}
  \\ \goodTerm{\Gm, \sub{\wsigproj{j}{2}{\wsig}}{(id, a)}}{b}{\El{(\wcode{\wsig})}}}
{\goodTerm{\Gm}{\wsup{T}{a}{b}}{\El{(\wcode{\wsig})}} }

\Rule[name=ind/cstr/subst ]
{\goodSub{\Gm}{\gm}{\Theta}}
{\goodTerm{\Gm}{\sub{\wsup{T}{a}{b}}{\gm} \equiv \wsup{\sub{T}{\gm}}{\sub{a}{\gm}}{\sub{b}{\gm^\uparrow}} }{\El{(\wcode{\sub{\wsig}{\gm}})}} }

\Rule[name=wsigeq/sub]{
  \goodWSig{\Gm}{\wsig}{n}
  \\ \goodType{\Gm}{A}{i}
  \\ \goodType{\Gm, A}{B}{i}
}{
  \goodWSig{\Gm}{\sub{\WSigSub{\WSigAdd{\wsig}{A}{B}}}{\gm} \equiv \wsig}{n}
}

\Rule[name=wsigeq/sub/subst]{
  \goodSub{\Gm}{\gm}{\Theta}
}{
  \goodWSig{\Gm}{\sub{\WSigSub{\wsig}}{\gm} \equiv \WSigSub{\sub{\wsig}{\gm}}}{n}
}


\end{mathparpagebreakable}
\begin{mathparpagebreakable}
\judgebox{\goodSig{\Gm}{\lsig}{n} }
\\
\Rule[name=ty/lkg]
{\goodSig{\Gm}{\lsig}{n}}
{\goodType{\Gm}{\TyLkg{\lsig}}{i}
\\ \goodType{\Gm}{\TyTkg{\lsig}}{}}

\Rule[name=ty/lkg/subst]
{\goodSig{\Delta}{\lsig}{n}
  \\ {\goodSub{\Gm}{\gm}{\Delta}}}
{\goodSig{\Gm}{ \sub {\lsig}{\gm}}{n}
  \\ \goodType{\Gm}{\TyLkg{ \sub{\lsig}{\gm}} \equiv \sub{(\TyLkg{\lsig})}{\gm}}{i}
  \\ \goodType{\Gm}{\TyTkg{ \sub{\lsig}{\gm}} \equiv \sub{(\TyTkg{\lsig})}{\gm}}{i}
  }
\\

\\
\Rule[name=lsig/ept]
{""}
{\goodSig{\Gm}{\LSigEmp}{0}}
 
\Rule[name=lsigeq/ept/eta]
{\goodSig{\Gm}{\lsig}{0}}
{\goodSig{\Gm}{\lsig \equiv \LSigEmp}{0}}

\Rule[name=lsig/add]
{\goodSig{\Gm}{\lsig}{n} 
 \\ \goodType{\Gm}{A}{}
 \\ \goodSeal{\Gm}{\seal}{\lsig}{A}
 \\ \goodType{\Gm, A}{T}{i}}
{\goodSig{\Gm}{(\LSigAdd {\lsig}{\seal}{T})}{n+1}}
\\

\\ 
\Rule[name=lsig/proj]
{\goodSig{\Theta}{\lsig}{n+1} 
\\ \goodSub{\Gm}{\gm}{\Theta}
}
{\goodSig{\Gm}{\lsigproj{1} {\lsig}}{n}
\\ \goodType{\Gm}{\lsigprojT {\lsig}}{}
\\ \goodSeal{\Gm}{\lsigproj{s}{\lsig}}{\lsigproj{1} {\lsig}}{\lsigprojT {\lsig}}
\\ \goodType{\Gm, \lsigprojT {\lsig}}{\lsigproj{2}{\lsig}}{} 
\\ 
\goodSig{\Gm}{\LSigAdd{\lsigproj{1} {\lsig}}{\lsigproj{s}{\lsig}}{\lsigproj{2}{\lsig}} \equiv \lsig }{n+1}
}
\\

\\ 
\Rule[name=lsigeq/proj/beta]
{\goodSig{\Gm}{\lsig}{n} 
\\ \goodType{\Gm}{A}{}
\\ \goodSeal{\Gm}{\seal}{\lsig}{A}
\\ \goodType{\Gm, A}{T}{i}}
{\goodSig{\Gm}{\lsigproj{1} {(\LSigAdd  {\lsig}  {\seal}  {T})} \equiv \lsig}{n}
\\ \goodType{\Gm}{\lsigprojT {(\LSigAdd  {\lsig} {\seal} {T})} \equiv A}{}
\\ \goodSeal{\Gm}{\lsigproj{s}{(\LSigAdd{\lsig} {\seal} {T})} \equiv \seal}{\lsig}{A}
\\ \goodType{\Gm, A}{\lsigproj{2}{(\LSigAdd {\lsig} {\seal}  {T})} \equiv T}{}
}
\\

\\ 
\Rule[name=lsig/add+proj/subst]
{\goodSig{\Gm}{\gm}{\Theta}}
{
\goodSig{\Gm}{\sub{\LSigEmp}{\gm} \equiv \LSigEmp}{n}
\\ \goodSig{\Gm}{\sub{(\LSigAdd {\lsig}{\seal}{T})}{\gm} \equiv 
  \LSigAdd {\sub{\lsig}{\gm}}{\sub{\seal}{\gm^\uparrow}}{\sub{T}{\gm^\uparrow}}
}{n+1}
\\ \goodSig{\Gm}{ \sub{\lsigproj{1}{\lsig}}{\gm} \equiv \lsigproj{1}{\sub{\lsig}{\gm}} }{n}
\\ \goodType{\Gm}{\sub{\lsigprojT {\lsig}}{\gm} \equiv \lsigprojT {\sub{\lsig}{\gm}}}{}
\\ \goodSeal{\Gm}{\sub{\lsigproj{s}{\lsig}}{\gm} \equiv {\lsigproj{s}{\sub{\lsig}{\gm}}} }{\lsig}{A}
\\ \goodType{\Gm, \lsigprojT {\sub{\lsig}{\gm}}}{ \sub{\lsigproj{2}{\lsig}}{\gm^\uparrow} \equiv  \lsigproj{2}{ \sub{\lsig}{\gm} }  }{}
}
\\


\\
\Rule[name=lnkg/ept]
{""}
{\goodTerm{\Gm}{\LkgEmp}{\TyLkg {\LSigEmp}}  
}
 
\Rule[name=lnkg/ept/eta]
{\goodTerm{\Gm}{o}{\TyLkg {\LSigEmp}}}
{\goodTerm{\Gm}{o \equiv \LkgEmp}{\TyLkg {\LSigEmp}}}
 
\Rule[name=lnkg/pkg]
{ \goodTerm{\Gm}{o}{\TyLkg {\lsig}} 
}
{
  \goodTerm{\Gm}{\Tkg {o}}{\TyTkg{\lsig}}
}

\Rule[name=lkg/pkg/subst]
{ \goodSub{\Gm}{\gm}{\Theta}
}
{
  \goodTerm{\Gm}{\sub{\Tkg {o}}{\gm} \equiv \Tkg {\sub{o}{\gm}}}{\TyTkg{\lsig}}
}
\\

\\
\Rule[name=lkg/add]
{ \goodTerm{\Gm}{o}{\TyLkg {\lsig}} 
\\ \goodType{\Gm}{A}{}
\\  \goodSeal{\Gm}{\seal}{\lsig}{A} 
\\  \goodTerm{\Gm, A}{t}{T}
}
{\goodTerm{\Gm}{(\LkgAdd {o} {t})}{\TyLkg{\LSigAdd {\lsig} {\seal} {T}}}
}

\Rule[name=lkgeq/add/eta]
{\goodTerm{\Gm}{o}{\TyLkg \lsig}}
{\goodTerm{\Gm}{\LkgAdd{\lkgproj{1}{o}}{\lkgproj{2}{o}}{\TyLkg{\lsig}} \equiv o }{\TyLkg{\lsig}}}
\\


\\
\Rule[name=lkg/proj]
{\goodTerm{\Gm}{o}{\TyLkg{\lsig}}}
{\goodTerm{\Gm}{\lkgproj{1} {o}}{\TyLkg {(\lsigproj{1} {\lsig})}}
\\ \goodTerm{\Gm, \lsigprojT {\lsig}}{\lkgproj{2}{o}}{\lsigproj{2}{\lsig}}
}
\\

\\ 
\Rule[name=lkgeq/proj/beta]
{\goodTerm{\Gm}{o}{\TyLkg {\lsig}} 
\\ \goodType{\Gm}{A}{}
\\  \goodSeal{\Gm}{f}{\lsig}{A} 
 \\ \goodTerm{\Gm, A}{t}{T}}
{\goodTerm{\Gm}{\lkgproj{1} {(\LkgAdd {o} {t})} \equiv o}{\TyLkg \lsig}
\\ \goodTerm{\Gm, A}{\lkgproj{2}{(\LkgAdd {o}{t})} \equiv t}{T}
}
\\
\\
\Rule[name=lkgeq/add+proj/subst]
{\goodSub{\Gm}{\gm}{\Theta}}
{
\goodTerm{\Gm}{\sub{\LkgEmp}{\gm} \equiv \LkgEmp}{\TyLkg {\LSigEmp}}
\\ \goodTerm{\Gm}{\sub{(\LkgAdd {o} {t}) }{\gm} \equiv (\LkgAdd {\sub{o}{\gm}} {\sub{t}{\gm^\uparrow}})}{\sub{\TyLkg{\LSigAdd {\lsig} {\seal} {T}}}{\gm}}
\\\\ \goodTerm{\Gm}{ \sub{\lkgproj{1} {o}}{\gm} \equiv \lkgproj{1} {\sub{o}{\gm}} }{\sub{\TyLkg (\lsigproj{1} {\lsig})}{\gm}}
\\
\goodTerm{\Gm, \lsigprojT {\sub{\lsig}{\gm}}}{\sub{\lkgproj{2}{o}}{\gm^\uparrow} \equiv \lkgproj{2}{\sub{o}{\gm}}}{\lsigproj{2}{\lsig}}}
\\


\\
\Rule[name=pkg/def]
{}
{\goodType{\Gm}{\TyTkg{\LSigEmp} \equiv \top}{} 
\\
\goodType{\Gm}{\TyTkg {\LSigAdd  {\lsig} {f} {T}} \equiv 
    \Sigma (\TyTkg {\lsig}) T["sf" \ f]}{}
\\\\ \goodTerm{\Gm}{ \Tkg {\LkgEmp} \equiv ()}{\TyTkg{\LSigEmp}}
\\ \goodTerm{\Gm}{\Tkg {(\LkgAdd {o} {t})} \equiv ((\Tkg {o}), t["sf" \ f][(id, \Tkg {o})]) }{}
}

\end{mathparpagebreakable}
\begin{mathparpagebreakable}
\judgebox{[\goodSeal{\Gm}{s}{\lsig}{A}] 
= [\goodTerm{\Gm, \TyTkg{\lsig}}{s}{A[\pi_1]}] }
\\
\Rule[name=seal/subst]
{ \goodSeal{\Delta}{s}{\lsig}{A}
  \\ {\goodSub{\Gm}{\gm}{\Delta}}}
{\goodSeal{\Gm}{ \sub{s}{\gm}}{ \sub{\lsig}{\gm}}{ \sub{A}{\gm}}}
\coloneq
\boxed{
\frac
{ \newline \goodTerm{\Delta, \TyTkg{\lsig}}{s}{ \sub{A}{\pi_1}}
  \\  \goodSub{\Gm}{\gm}{\Delta}  }
{\goodTerm{\Gm,\TyTkg{\sub{\lsig}{\gm}}}{ \sub{s}{\gm^\uparrow}}{\sub{\sub{A}{\pi_1}}{\gm^\uparrow}\equiv \sub{\sub{A}{\gm}}{\pi_1}}}}
\\
\\
\Rule[name=seal/id]
{}
{\goodSeal{\Gm}{id_s}{\lsig}{\TyTkg {\lsig}}}
\coloneq \boxed{\goodTerm{\Gm, \TyTkg{\lsig}}{\pi_2}{\TyTkg{\sub{\lsig}{\pi_1}}}}
\\

\medskip


\\
\Rule[name=ty/casesig]
{\goodType{\Gm}{A}{}
\\ \goodType{\Gm, A}{B}{}
\\ \goodType{\Gm}{R}{}
}
{\goodType{\Gm}{\CaseSig{A}{B}{R} \equiv (\TyPi {A} {(\TyPi {(\TyPi {B} {(\sub{R}{ \SubstComp {\pi_1}{\pi_1}})})} {\sub{R}{\SubstComp{\pi_1}{\pi_1}}})} )}{}}
\\

\\
\Rule[name=reclkg/defN]
{\goodWSig{\Gm}{\wsig}{n+1}
}
{\goodSig{\Gm}{\RecSig{\wsig}{R} \equiv 
        \LSigAdd{\RecSig{\WSigSub{\wsig}}{R}}
        {\pi_2}
        {\CaseSig{\wsigproj{0}{1}{\wsig}}{\wsigproj{0}{2}{\wsig}}{R}} }{n+1}}
\\

\\
\Rule[name=reclkg/def0]
{\goodWSig{\Gm}{\wsig}{0}
}
{\goodSig{\Gm}{\RecSig{\wsig}{R} \equiv \LSigEmp}{0}}

\Rule[name=reclkg/proj]
{ \goodWSig{\Gm}{\wsig}{N}
\\ \goodTerm{\Gm}{o}{\TyLkg{(\RecSig{\wsig}{R})}}
\\ j < N
}
{\goodTerm{\Gm}{\Recproj{j}{o}}{\sub{(\CaseSig{(\pi_1^j \wsig)}{(\pi_2^j \wsig)}{R})}{\pi_1}}}
\\
\\
\Rule[name=tm/wrec]
{ \goodWSig{\Gm}{\wsig}{N}
\\ \goodType{\Gm}{R}{}
\\ \goodTerm{\Gm}{r}{\TyLkg{(\RecSig{\wsig}{R})}}
\\ \goodTerm{\Gm}{w}{\El{(\wcode{\wsig})}}
}
{\goodTerm{\Gm}{\Wrec{w}{r}}{R}}
\\

\\
\Rule[name=reclkg/proj/beta]{
  \goodWSig{\Gm}{\wsig}{N}
  \\ j < N
  \\ \goodTerm{\Gm}{o}{\TyLkg{\RecSig{\wsig}{R}}}
}{
  \goodTerm{\Gm}{\Recproj{j}{o}}{
    \CaseSig{\wsigproj{j}{1}{\wsig}}{\wsigproj{j}{2}{\wsig}}{R}}
}
\\

\\
\Rule[name=reclkg/proj/defN]{}{
  \goodTerm{\Gm}{\Recproj{n+1}{o} \equiv \Recproj{n}{ \lkgproj{1}{o}}}{...}
}
 
\Rule[name=reclkg/proj/def0]{}{
  \goodTerm{\Gm}{\Recproj{0}{o} \equiv \sub{\lkgproj{2}{o}}{("id", \Tkg{\lkgproj{1}{o}})}}{...}
}
\\

\\
\Rule[name=tmeq/rec/beta]
{\goodTerm{\Gamma}{h}{\cL(\RecSig{\tau}{R})} 
\\ \goodTerm{\Gamma}{T}{\TyWSingle{\tau}}}
{\goodTerm{\Gamma}{\Wrec{h}{(\wsup{\wsig}{a}{b})} \equiv 
(\app{((\app{(\Recproj{j}{h})} )[("id", a)])} )[("id", \lam{(\Wrec{h[\pi_1]}{b})})]
}{R}}
\end{mathparpagebreakable}
\begin{mathparpagebreakable}

\judgebox{\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}}

\\
\Rule[name=inh/id]
{""}
{\goodInh{\Gm}{\InhId}{\lsig}{\lsig}}

\Rule[name=inh/ov]
{
\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}  
\\ \goodType{\Gm, A_1}{T_1}{}
\\ \goodType{\Gm, A_2}{T_2}{}
  \\ \goodTerm{\Gm, A_2}{t}{T_2}}
{\goodInh{\Gm}{\InhOv{h}{t}}{(\LSigAdd  {\sigma_1 } {\seal_1} {T_1})}{(\LSigAdd   {\sigma_2} {\seal_2} {T_2})}}
\\

\\
\Rule[name=inh/ext]
{\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}
  \\ \goodTerm{\Gm, A_2}{t}{T}}
{\goodInh{\Gm}{\InhExt {h} {t}}{\sigma_1}{(\LSigAdd {\sigma_2} {\seal_2} { T})}}

\Rule[name=inh/inh]
{\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}
\\ \goodType{\Gm, A_1}{T}{}
\\ \goodTerm{\Gm, A_2}{\uparrow^s}{\sub{A_1}{\pi_1}}
}
{\goodInh{\Gm}{\InhInh{h}}{(\LSigAdd {\sigma_1} {\seal_1}  {T})}{(\LSigAdd   {\sigma_2} {\seal_2} {T[(\pi_1, \uparrow^s)]})}}
\\
\\
\Rule[name=tm/inh]
{\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}
\\ \goodTerm{\Gm}{l}{\TyLkg{\sigma_1}}
}
{\goodTerm{\Gm}{(\inh {h} {l})}{\TyLkg{\sigma_2}}} 

\Rule[name=inh/nest]
{\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}
\\ \goodTerm{\Gm, A_2}{\uparrow^s}{\sub{A_1}{\pi_1}}
\\\\
\goodInh{\Gm, A_2}{i}{\tau_1[(\pi_1, \uparrow^s)]}{\tau_2}}
{\goodInh{\Gm}{\InhNest{h}{i}}{(\LSigAdd {\sigma_1} {\seal_1}  {\TyLkg\tau_1})}{(\LSigAdd   {\sigma_2} {\seal_2} {\TyLkg{\tau_2})}}}
\\

\\
\Rule[name=inh/id/beta]
{ \goodTerm{\Gm}{o}{\TyLkg{\sigma} }}
{\goodTerm{\Gm}{\inh {(\InhId)} {o} \equiv o}{...}}

\Rule[name=inh/ext/beta]
{
  \goodInh{\Gm}{h}{\sigma_1}{\sigma_2}
  \\ \goodTerm{\Gm, A_2}{t}{T}
  \\ \goodTerm{\Gm}{o}{\TyLkg{\sigma_1}}
}
{\goodTerm{\Gm}{\inh {\goodInh{\Gm}{\InhExt {h} {t}}{\sigma_1}{(\LSigAdd {\sigma_2} {\seal_2} { T})}} {o}
\equiv \LkgAdd{\inh {h}{o}}{t}
}{...}}
\\

\\
\Rule[name=inh/inh/beta]
{\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}
  \\ \goodTerm{\Gm}{m}{\TyLkg {\sigma_1}}
  \\ \goodTerm{\Gm, A_1}{t}{T}
  \\ \goodTerm{\Gm, A_2}{\uparrow^s}{\sub{A_1}{\pi_1}}
}
{\goodTerm{\Gm}{\inh {(\InhInh{h})} {(\LkgAdd{m}{t})} \newline  \equiv \LkgAdd{(\inh {h} {m})}  {t[(\pi_1, \uparrow^s)]}}{...}} 
\\

\\
\Rule[name=inh/ov/beta]
{\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}  
\\ \goodType{\Gm, A_1}{T_1}{}
\\ \goodType{\Gm, A_2}{T_2}{}
\\ \goodTerm{\Gm, A_2}{t}{T_2}}
{
\goodTerm{\Gm}
  {\inh
  { \InhOv{h}{t} }{\LkgAdd{o}{t}}
  \equiv 
  \LkgAdd{\inh{h}{o}}{t}}
  {...}
}
\\

\\
\Rule[name=inh/nest/beta]
{\goodInh{\Gm}{h}{\sigma_1}{\sigma_2}
\\ \goodTerm{\Gm, A_2}{\uparrow^s}{\sub{A_1}{\pi_1}}
\\
\goodInh{\Gm, A_2}{i}{\tau_1[(\pi_1, \uparrow^s)]}{\tau_2}}
{
\goodTerm{\Gm}
{
\inh{\InhNest{h}{i}}{\LkgAdd{o}{t}} \equiv 
\LkgAdd{\inh{h}{o}}{\inh{i}{\sub{t}{ \SubstExt{\pi_1}{\uparrow^s}}}}
}
{...}
}

\end{mathparpagebreakable}
