\begin{figure}
\lstset{
    basicstyle=\fontsize{8}{8.5}\ttfamily,
% numbers=left,
}

\begin{minipage}{\textwidth}
\begin{multicols}{2}

\definecolor{codecomment-color}{HTML}{DD033F}

\begin{lstlisting}
Family STLC_isorec extends STLC.[@\tanc{STLCisorec-start}@]
[@\hfill\codecomment{STLC extended with iso-recursive types}@]
FInductive ty : Set +=
| ty_var : id -> ty | ty_rec : id -> ty -> ty.

FInductive tm : Set +=
| tm_fold : tm -> tm | tm_unfold : tm -> tm.

FRecursion tysubst on ty[@\hfill\codecomment{Type-level substitution}@]
motive \lambda(_ : ty), id -> ty -> ty.
Case ty_unit  := [@\dadada@].   Case ty_arrow := [@\dadada@].
Case ty_var   := [@\dadada@].   Case ty_rec   := [@\dadada@].
End tysubst.

FInductive hasty : env -> tm -> ty -> Prop +=
| ht_fold : \forall G t \alpha T,
    hasty G t (tysubst T \alpha (ty_rec \alpha T)) ->
    hasty G (tm_fold t) (ty_rec \alpha T)
| ht_unfold : [@\dadada@].

[@\dadada@][@\hfill\codecomment{Other adjustments}@]
End STLC_isorec.[@\tanc{STLCisorec-end}@]
\end{lstlisting}

\makeline[0pt]{STLCisorec-start}{STLCisorec-end}[codecomment-color!50]

\vspace{-12pt}

\definecolor{codecomment-color}{HTML}{008B8B}

\begin{lstlisting}
Family STLC_fix_isorec extends STLC[@\tanc{STLCisorecfix-start}@]
using STLC_fix, STLC_isorec.
[@\hfill\ \ \codecomment{STLC extended with fixpoints and iso-recursive types}@]
End STLC_fix_isorec.[@\tanc{STLCisorecfix-end}@]
\end{lstlisting}

\makeline[0pt]{STLCisorecfix-start}{STLCisorecfix-end}[codecomment-color!50]

\columnbreak

\definecolor{codecomment-color}{HTML}{0DA3FF}

\begin{lstlisting}
Family STLC_prod extends STLC.[@\tanc{STLCprod-start}@]
[@\hfill\codecomment{STLC extended with products}@]
FInductive ty : Set +=
| ty_prod : ty -> ty -> ty.

FInductive tm : Set +=
| tm_pair : tm -> tm -> tm
| tm_fst : tm -> tm | tm_snd : tm -> tm.

[@\dadada@][@\hfill\codecomment{Other adjustments}@]
End STLC_prod.[@\tanc{STLCprod-end}@]
\end{lstlisting}

\makeline[.5\textwidth+9pt]{STLCprod-start}{STLCprod-end}[codecomment-color!50]

\vspace{-10pt}

\definecolor{codecomment-color}{HTML}{E8A20C}

\begin{lstlisting}
Family STLC_prod_isorec extends STLC[@\tanc{STLCisorecprod-start}@]
using STLC_prod, STLC_isorec.
[@\hfill\ \ \codecomment{STLC extended with products and iso-recursive types}@]
FRecursion tysubst on ty
motive \lambda(_ : ty), id -> ty -> ty.
Case ty_prod := [@\dadada@].[@\hfill\codecomment{Substitution on product types}@]
End tysubst.

End STLC_prod_isorec.[@\tanc{STLCisorecprod-end}@]
\end{lstlisting}

\makeline[.5\textwidth+9pt]{STLCisorecprod-start}{STLCisorecprod-end}[codecomment-color!50]

\vspace{-10pt}

\definecolor{codecomment-color}{HTML}{708090}

\begin{lstlisting}
Family STLC_fix_prod_isorec extends STLC[@\tanc{STLCisorecfixprod-start}@]
using STLC_fix, STLC_prod_isorec.[@\hfill\codecommentstart{STLC extended}@]
[@\hfill\codecommentend{with fixpoints, products, and iso-recursive types}@]
End STLC_fix_isorec.[@\tanc{STLCisorecfixprod-end}@]
\end{lstlisting}

\makeline[.5\textwidth+9pt]{STLCisorecfixprod-start}{STLCisorecfixprod-end}[codecomment-color!50]

\end{multicols}
\end{minipage}

\caption{Composing extensions of STLC.}
\label{fig:stlc-isorec-prod}
\end{figure}